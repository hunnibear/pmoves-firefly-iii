{"version":3,"sources":["webpack:///src/components/accounts/Index.vue","webpack:///./src/components/accounts/Index.vue?6395","webpack:///./src/components/accounts/Index.vue","webpack:///./src/components/accounts/Index.vue?e838","webpack:///./src/pages/accounts/index.js"],"names":["name","props","accountTypes","String","data","accounts","type","loading","ready","fields","currentPage","perPage","total","watch","datesReady","value","this","getAccountList","computed","start","end","cardTitle","$t","created","parts","length","params","get","parseInt","push","methods","listPageSize","downloadAccountList","console","log","page","axios","roleTranslate","role","parsePages","pagination","parseAccounts","hasOwnProperty","key","test","acct","id","current","title","attributes","account_role","iban","account_number","current_balance","currency_code","balance_diff","getAccountBalanceDifference","promises","Promise","resolve","toISOString","split","all","then","loadAccounts","_vm","_h","$createElement","_c","_self","staticClass","attrs","model","callback","$$v","expression","_v","scopedSlots","_u","fn","item","_s","_e","parseFloat","Intl","NumberFormat","style","currency","format","require","i18n","Vue","component","BTable","BPagination","store","el","render","createElement","Index","beforeCreate","$store","commit","dispatch"],"mappings":"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","file":"/public/js/accounts/index.js","sourcesContent":["<!--\n  - Index.vue\n  - Copyright (c) 2020 james@firefly-iii.org\n  -\n  - This file is part of Firefly III (https://github.com/firefly-iii).\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program.  If not, see <https://www.gnu.org/licenses/>.\n  -->\n\n<template>\n  <div>\n    <div class=\"row\">\n      <div class=\"col-lg-12 col-md-12 col-sm-12 col-xs-12\">\n        <b-pagination\n            v-model=\"currentPage\"\n            :total-rows=\"total\"\n            :per-page=\"perPage\"\n            aria-controls=\"my-table\"\n        ></b-pagination>\n      </div>\n    </div>\n    <div class=\"row\">\n      <div class=\"col-lg-12 col-md-12 col-sm-12 col-xs-12\">\n        <div class=\"card\">\n          <div class=\"card-header\">\n\n            <!--\n            <div class=\"card-tools\">\n              <div class=\"input-group input-group-sm\" style=\"width: 150px;\">\n                <input class=\"form-control float-right\" name=\"table_search\" :placeholder=\"$t('firefly.search')\" type=\"text\">\n\n                <div class=\"input-group-append\">\n                  <button class=\"btn btn-default\" type=\"submit\">\n                    <i class=\"fas fa-search\"></i>\n                  </button>\n                </div>\n              </div>\n            </div>\n            -->\n\n\n          </div>\n          <div class=\"card-body p-0\">\n            <!--\n                <td style=\"text-align: right;\">\n\n\n                </td>\n                <td>\n                  <div class=\"btn-group btn-group-sm dropleft\">\n                    <div class=\"dropdown\">\n                      <button class=\"btn btn-light btn-sm dropdown-toggle\" type=\"button\" :id=\"'dropdownMenuButton' + account.id\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n                        {{ $t('firefly.actions') }}\n                      </button>\n                      <div class=\"dropdown-menu\" :aria-labelledby=\"'dropdownMenuButton' + account.id\">\n                        <a class=\"dropdown-item\" :href=\"'./accounts/edit/' + account.id\"><i class=\"fa fas fa-pencil-alt\"></i> {{ $t('firefly.edit') }}</a>\n                        <a class=\"dropdown-item\" :href=\"'./accounts/delete/' + account.id\"><i class=\"fa far fa-trash\"></i> {{ $t('firefly.delete') }}</a>\n                        <a v-if=\"'asset' === type\" class=\"dropdown-item\" :href=\"'./accounts/reconcile/' + account.id\"><i class=\"fas fa-check\"></i> {{ $t('firefly.reconcile_this_account') }}</a>\n                      </div>\n                    </div>\n                  </div>\n                </td>\n              </tr>\n              </tbody>\n            </table>\n            -->\n\n            <b-table id=\"my-table\" striped hover primary-key=\"id\"\n                     :items=\"accounts\" :fields=\"fields\"\n                     :per-page=\"perPage\"\n                     :current-page=\"currentPage\"\n            >\n              <template #cell(title)=\"data\">\n                <a :href=\"'./accounts/show/' + data.item.id\" :title=\"data.value\">{{ data.value }}</a>\n              </template>\n              <template #cell(number)=\"data\">\n                <span v-if=\"null !== data.item.iban && null === data.item.account_number\">{{ data.item.iban }}</span>\n                <span v-if=\"null === data.item.iban && null !== data.item.account_number\">{{ data.item.account_number }}</span>\n                <span v-if=\"null !== data.item.iban && null !== data.item.account_number\">{{ data.item.iban }} ({{ data.item.account_number }})</span>\n              </template>\n              <template #cell(current_balance)=\"data\">\n                <span class=\"text-success\" v-if=\"parseFloat(data.item.current_balance) > 0\">\n                  {{\n                    Intl.NumberFormat('en-US', {\n                      style: 'currency', currency:\n                      data.item.currency_code\n                    }).format(data.item.current_balance)\n                  }}\n                </span>\n                <span class=\"text-danger\" v-if=\"parseFloat(data.item.current_balance) < 0\">\n                  {{\n                    Intl.NumberFormat('en-US', {\n                      style: 'currency', currency:\n                      data.item.currency_code\n                    }).format(data.item.current_balance)\n                  }}\n                </span>\n\n                <span class=\"text-muted\" v-if=\"0 === parseFloat(data.item.current_balance)\">\n                  {{\n                    Intl.NumberFormat('en-US', {\n                      style: 'currency', currency:\n                      data.item.currency_code\n                    }).format(data.item.current_balance)\n                  }}\n                </span>\n                <span v-if=\"'asset' === type && 'loading' === data.item.balance_diff\">\n                  <i class=\"fas fa-spinner fa-spin\"></i>\n                </span>\n                <span v-if=\"'asset' === type && 'loading' !== data.item.balance_diff\">\n                   (<span class=\"text-success\" v-if=\"parseFloat(data.item.balance_diff) > 0\">{{\n                    Intl.NumberFormat('en-US', {\n                      style: 'currency', currency:\n                      data.item.currency_code\n                    }).format(data.item.balance_diff)\n                  }}</span><span class=\"text-muted\" v-if=\"0===parseFloat(data.item.balance_diff)\">{{\n                    Intl.NumberFormat('en-US', {\n                      style: 'currency', currency:\n                      data.item.currency_code\n                    }).format(data.item.balance_diff)\n                  }}</span><span class=\"text-danger\" v-if=\"parseFloat(data.item.balance_diff) < 0\">{{\n                    Intl.NumberFormat('en-US', {\n                      style: 'currency', currency:\n                      data.item.currency_code\n                    }).format(data.item.balance_diff)\n                  }}</span>)\n\n\n                </span>\n              </template>\n            </b-table>\n\n\n          </div>\n          <div class=\"card-footer\">\n            <a :href=\"'./accounts/create/' + type\" class=\"btn btn-success\" :title=\"$t('firefly.create_new_' + type)\">{{ $t('firefly.create_new_' + type) }}</a>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n\nimport {createNamespacedHelpers} from \"vuex\";\nimport {mapGetters} from \"vuex\";\n// import {createNamespacedHelpers}\n//const {mapState, mapGetters, mapActions, mapMutations} = createNamespacedHelpers('');\n//const {rootMapState, rootMapGetters, rootMapActions, rootMapMutations} = createNamespacedHelpers('')\n\nexport default {\n  name: \"Index\",\n  props: {\n    accountTypes: String\n  },\n  data() {\n    return {\n      accounts: [],\n      type: 'all',\n      loading: true,\n      ready: false,\n      fields: [],\n      currentPage: 1,\n      perPage: 50,\n      total: 0\n    }\n  },\n  watch: {\n    datesReady: function (value) {\n      if (true === value) {\n        this.getAccountList();\n      }\n    },\n  },\n  computed: {\n    ...mapGetters('', ['listPageSize']),\n    ...mapGetters('dashboard/index', [\n      'start',\n      'end',\n    ]),\n    'datesReady': function () {\n      return null !== this.start && null !== this.end && this.ready;\n    },\n    cardTitle: function () {\n      return this.$t('firefly.' + this.type + '_accounts');\n    }\n  },\n  created() {\n    let pathName = window.location.pathname;\n    let parts = pathName.split('/');\n    this.type = parts[parts.length - 1];\n\n    let params = new URLSearchParams(window.location.search);\n    this.currentPage = params.get('page') ? parseInt(params.get('page')) : 1;\n\n\n    // per page:\n    //this.perPage = this.get\n\n    this.fields = [\n      {\n        key: 'title',\n        label: this.$t('list.name'),\n        sortable: true\n      }\n    ];\n    // TODO sortable handle\n    // TODO menu.\n    // add extra field\n    if ('asset' === this.type) {\n      this.fields.push(\n          {\n            key: 'role',\n            label: this.$t('list.role'),\n            sortable: true\n          }\n      );\n    }\n\n    // add the rest\n    this.fields.push(\n        {\n          key: 'number',\n          label: this.$t('list.iban'),\n          sortable: false\n        }\n    );\n    this.fields.push(\n        {\n          key: 'current_balance',\n          label: this.$t('list.currentBalance'),\n          sortable: true\n        }\n    );\n    this.fields.push(\n        {\n          key: 'menu',\n          label: ' ',\n          sortable: false\n        }\n    );\n    this.ready = true;\n  },\n\n  methods: {\n    getAccountList: function () {\n      this.perPage = this.listPageSize;\n      this.accounts = [];\n      // needs to be async so call itself again:\n      this.downloadAccountList(1);\n    },\n\n    downloadAccountList(page) {\n      console.log('Downloading page ' + page);\n      axios.get('./api/v1/accounts?type=' + this.type + '&page=' + page)\n          .then(response => {\n                  let currentPage = parseInt(response.data.meta.pagination.current_page);\n                  let totalPage = parseInt(response.data.meta.pagination.total_pages);\n                  this.total = parseInt(response.data.meta.pagination.total);\n                  this.parseAccounts(response.data.data);\n                  if (currentPage < totalPage) {\n                    let nextPage = currentPage + 1;\n                    this.downloadAccountList(nextPage);\n                  }\n                }\n          );\n    },\n    roleTranslate: function (role) {\n      if (null === role) {\n        return '';\n      }\n      return this.$t('firefly.account_role_' + role);\n    },\n    parsePages: function (data) {\n      this.total = parseInt(data.pagination.total);\n    },\n    parseAccounts: function (data) {\n      for (let key in data) {\n        if (data.hasOwnProperty(key) && /^0$|^[1-9]\\d*$/.test(key) && key <= 4294967294) {\n          let current = data[key];\n          let acct = {};\n          acct.id = current.id;\n          acct.title = current.attributes.name;\n          acct.role = this.roleTranslate(current.attributes.account_role);\n          acct.iban = current.attributes.iban;\n          acct.account_number = current.attributes.account_number;\n          acct.current_balance = current.attributes.current_balance;\n          acct.currency_code = current.attributes.currency_code;\n          acct.balance_diff = 'loading';\n\n\n          this.accounts.push(acct);\n          if ('asset' === this.type) {\n            this.getAccountBalanceDifference(this.accounts.length - 1, current);\n          }\n        }\n      }\n    },\n    getAccountBalanceDifference: function (index, acct) {\n      // get account on day 0\n      let promises = [];\n\n      // add meta data to promise context.\n      promises.push(new Promise((resolve) => {\n        resolve(\n            {\n              account: acct,\n              index: index,\n            }\n        );\n      }));\n\n      promises.push(axios.get('./api/v1/accounts/' + acct.id + '?date=' + this.start.toISOString().split('T')[0]));\n      promises.push(axios.get('./api/v1/accounts/' + acct.id + '?date=' + this.end.toISOString().split('T')[0]));\n\n      Promise.all(promises).then(responses => {\n        let index = responses[0].index;\n        let startBalance = parseFloat(responses[1].data.data.attributes.current_balance);\n        let endBalance = parseFloat(responses[2].data.data.attributes.current_balance);\n        this.accounts[index].balance_diff = endBalance - startBalance;\n      });\n    },\n    loadAccounts: function (data) {\n      for (let key in data) {\n        if (data.hasOwnProperty(key) && /^0$|^[1-9]\\d*$/.test(key) && key <= 4294967294) {\n          let acct = data[key];\n          this.accounts.push(acct);\n        }\n      }\n    },\n  }\n}\n</script>\n\n<style scoped>\n\n</style>\n","import mod from \"-!../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Index.vue?vue&type=template&id=00cc6a9e&scoped=true&\"\nimport script from \"./Index.vue?vue&type=script&lang=js&\"\nexport * from \"./Index.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"00cc6a9e\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"col-lg-12 col-md-12 col-sm-12 col-xs-12\"},[_c('b-pagination',{attrs:{\"total-rows\":_vm.total,\"per-page\":_vm.perPage,\"aria-controls\":\"my-table\"},model:{value:(_vm.currentPage),callback:function ($$v) {_vm.currentPage=$$v},expression:\"currentPage\"}})],1)]),_vm._v(\" \"),_c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"col-lg-12 col-md-12 col-sm-12 col-xs-12\"},[_c('div',{staticClass:\"card\"},[_c('div',{staticClass:\"card-header\"}),_vm._v(\" \"),_c('div',{staticClass:\"card-body p-0\"},[_c('b-table',{attrs:{\"id\":\"my-table\",\"striped\":\"\",\"hover\":\"\",\"primary-key\":\"id\",\"items\":_vm.accounts,\"fields\":_vm.fields,\"per-page\":_vm.perPage,\"current-page\":_vm.currentPage},scopedSlots:_vm._u([{key:\"cell(title)\",fn:function(data){return [_c('a',{attrs:{\"href\":'./accounts/show/' + data.item.id,\"title\":data.value}},[_vm._v(_vm._s(data.value))])]}},{key:\"cell(number)\",fn:function(data){return [(null !== data.item.iban && null === data.item.account_number)?_c('span',[_vm._v(_vm._s(data.item.iban))]):_vm._e(),_vm._v(\" \"),(null === data.item.iban && null !== data.item.account_number)?_c('span',[_vm._v(_vm._s(data.item.account_number))]):_vm._e(),_vm._v(\" \"),(null !== data.item.iban && null !== data.item.account_number)?_c('span',[_vm._v(_vm._s(data.item.iban)+\" (\"+_vm._s(data.item.account_number)+\")\")]):_vm._e()]}},{key:\"cell(current_balance)\",fn:function(data){return [(parseFloat(data.item.current_balance) > 0)?_c('span',{staticClass:\"text-success\"},[_vm._v(\"\\n                \"+_vm._s(Intl.NumberFormat('en-US', {\n                    style: 'currency', currency:\n                    data.item.currency_code\n                  }).format(data.item.current_balance))+\"\\n              \")]):_vm._e(),_vm._v(\" \"),(parseFloat(data.item.current_balance) < 0)?_c('span',{staticClass:\"text-danger\"},[_vm._v(\"\\n                \"+_vm._s(Intl.NumberFormat('en-US', {\n                    style: 'currency', currency:\n                    data.item.currency_code\n                  }).format(data.item.current_balance))+\"\\n              \")]):_vm._e(),_vm._v(\" \"),(0 === parseFloat(data.item.current_balance))?_c('span',{staticClass:\"text-muted\"},[_vm._v(\"\\n                \"+_vm._s(Intl.NumberFormat('en-US', {\n                    style: 'currency', currency:\n                    data.item.currency_code\n                  }).format(data.item.current_balance))+\"\\n              \")]):_vm._e(),_vm._v(\" \"),('asset' === _vm.type && 'loading' === data.item.balance_diff)?_c('span',[_c('i',{staticClass:\"fas fa-spinner fa-spin\"})]):_vm._e(),_vm._v(\" \"),('asset' === _vm.type && 'loading' !== data.item.balance_diff)?_c('span',[_vm._v(\"\\n                 (\"),(parseFloat(data.item.balance_diff) > 0)?_c('span',{staticClass:\"text-success\"},[_vm._v(_vm._s(Intl.NumberFormat('en-US', {\n                    style: 'currency', currency:\n                    data.item.currency_code\n                  }).format(data.item.balance_diff)))]):_vm._e(),(0===parseFloat(data.item.balance_diff))?_c('span',{staticClass:\"text-muted\"},[_vm._v(_vm._s(Intl.NumberFormat('en-US', {\n                    style: 'currency', currency:\n                    data.item.currency_code\n                  }).format(data.item.balance_diff)))]):_vm._e(),(parseFloat(data.item.balance_diff) < 0)?_c('span',{staticClass:\"text-danger\"},[_vm._v(_vm._s(Intl.NumberFormat('en-US', {\n                    style: 'currency', currency:\n                    data.item.currency_code\n                  }).format(data.item.balance_diff)))]):_vm._e(),_vm._v(\")\\n\\n\\n              \")]):_vm._e()]}}])})],1),_vm._v(\" \"),_c('div',{staticClass:\"card-footer\"},[_c('a',{staticClass:\"btn btn-success\",attrs:{\"href\":'./accounts/create/' + _vm.type,\"title\":_vm.$t('firefly.create_new_' + _vm.type)}},[_vm._v(_vm._s(_vm.$t('firefly.create_new_' + _vm.type)))])])])])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","/*\n * index.js\n * Copyright (c) 2020 james@firefly-iii.org\n *\n * This file is part of Firefly III (https://github.com/firefly-iii).\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport Vue from \"vue\";\nimport Index from \"../../components/accounts/Index\";\nimport store from \"../../components/store\";\nimport {BTable, BPagination} from 'bootstrap-vue';\n\nrequire('../../bootstrap');\n\n// i18n\nlet i18n = require('../../i18n');\n\nlet props = {};\n\n\nVue.component('b-table', BTable);\nVue.component('b-pagination', BPagination);\n\n\nnew Vue({\n            i18n,\n            store,\n            el: \"#accounts\",\n            render: (createElement) => {\n                return createElement(Index, {props: props});\n            },\n            beforeCreate() {\n                this.$store.commit('initialiseStore');\n                this.$store.dispatch('updateCurrencyPreference');\n                this.$store.dispatch('updateListPageSizePreference');\n                // also init the dashboard store.\n                this.$store.dispatch('dashboard/index/initialiseStore');\n            },\n        });\n"],"sourceRoot":""}