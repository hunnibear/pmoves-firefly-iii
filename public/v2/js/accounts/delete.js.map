{"version":3,"sources":["webpack:///./src/bootstrap.js","webpack:///./src/i18n.js","webpack:///./src/components/accounts/Delete.vue","webpack:///./src/components/accounts/Delete.vue?4b61","webpack:///./src/pages/accounts/delete.js"],"names":["window","$","jQuery","require","axios","defaults","headers","common","token","document","head","querySelector","content","console","error","localeToken","localStorage","locale","vuei18n","VueI18n","uiv","Vue","module","exports","documentElement","lang","fallbackLocale","messages","class","name","data","loading","deleting","deleted","accountId","accountName","piggyBankCount","transactionCount","moveToAccount","accounts","created","parts","location","pathname","split","this","parseInt","length","getAccount","methods","deleteAccount","execDeleteAccount","moveTransactions","post","original_account","destination_account","then","response","href","previousURL","get","account","attributes","getPiggyBankCount","type","currency_code","getAccounts","currencyCode","i","hasOwnProperty","test","current","active","id","push","meta","pagination","total","getTransactionCount","$t","$tc","label","value","i18n","props","render","createElement","Delete","$mount"],"mappings":"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","file":"/public/js/accounts/delete.js","sourcesContent":["/*\n * bootstrap.js\n * Copyright (c) 2021 james@firefly-iii.org\n *\n * This file is part of Firefly III (https://github.com/firefly-iii).\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program.  If not, see <https://www.gnu.org/licenses/>.\n */\n\n// // imports\nimport Vue from 'vue';\nimport VueI18n from 'vue-i18n'\nimport * as uiv from 'uiv';\n\n// export jquery for others scripts to use\nwindow.$ = window.jQuery = require('jquery');\n\n// axios\nwindow.axios = require('axios');\nwindow.axios.defaults.headers.common['X-Requested-With'] = 'XMLHttpRequest';\n\n// CSRF\nlet token = document.head.querySelector('meta[name=\"csrf-token\"]');\n\nif (token) {\n    window.axios.defaults.headers.common['X-CSRF-TOKEN'] = token.content;\n} else {\n    console.error('CSRF token not found: https://laravel.com/docs/csrf#csrf-x-csrf-token');\n}\n\n// locale\nlet localeToken = document.head.querySelector('meta[name=\"locale\"]');\n\nif (localeToken) {\n    localStorage.locale = localeToken.content;\n} else {\n    localStorage.locale = 'en_US';\n}\n\n// admin stuff\nrequire('jquery-ui');\nrequire('bootstrap'); // bootstrap CSS?\n\nrequire('admin-lte/dist/js/adminlte');\nrequire('overlayscrollbars');\n\n\n// vue\nwindow.vuei18n = VueI18n;\nwindow.uiv = uiv;\nVue.use(vuei18n);\nVue.use(uiv);\nwindow.Vue = Vue;","/*\n * i18n.js\n * Copyright (c) 2020 james@firefly-iii.org\n *\n * This file is part of Firefly III (https://github.com/firefly-iii).\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program.  If not, see <https://www.gnu.org/licenses/>.\n */\n\n// Create VueI18n instance with options\nmodule.exports = new vuei18n({\n    locale: document.documentElement.lang, // set locale\n    fallbackLocale: 'en',\n    messages: {\n        'bg': require('./locales/bg.json'),\n        'cs': require('./locales/cs.json'),\n        'de': require('./locales/de.json'),\n        'en': require('./locales/en.json'),\n        'en-us': require('./locales/en.json'),\n        'en-gb': require('./locales/en-gb.json'),\n        'es': require('./locales/es.json'),\n        'el': require('./locales/el.json'),\n        'fr': require('./locales/fr.json'),\n        'hu': require('./locales/hu.json'),\n        //'id': require('./locales/id.json'),\n        'it': require('./locales/it.json'),\n        'nl': require('./locales/nl.json'),\n        'nb': require('./locales/nb.json'),\n        'pl': require('./locales/pl.json'),\n        'fi': require('./locales/fi.json'),\n        'pt-br': require('./locales/pt-br.json'),\n        'pt-pt': require('./locales/pt.json'),\n        'ro': require('./locales/ro.json'),\n        'ru': require('./locales/ru.json'),\n        //'zh': require('./locales/zh.json'),\n        'zh-tw': require('./locales/zh-tw.json'),\n        'zh-cn': require('./locales/zh-cn.json'),\n        'sk': require('./locales/sk.json'),\n        'sv': require('./locales/sv.json'),\n        'vi': require('./locales/vi.json'),\n    }\n});\n","<!--\n  - Delete.vue\n  - Copyright (c) 2021 james@firefly-iii.org\n  -\n  - This file is part of Firefly III (https://github.com/firefly-iii).\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program.  If not, see <https://www.gnu.org/licenses/>.\n  -->\n\n<template>\n  <div>\n    <div class=\"col-lg-6 col-md-12 col-sm-12 col-xs-12 offset-lg-3\">\n      <div class=\"card card-default card-danger\">\n        <div class=\"card-header\">\n          <h3 class=\"card-title\">\n            <span class=\"fas fa-exclamation-triangle\"></span>\n            {{ $t('firefly.delete_account') }}\n          </h3>\n        </div>\n        <!-- /.card-header -->\n        <div class=\"card-body\">\n          <div class=\"callout callout-danger\" v-if=\"!deleting && !deleted\">\n            <p>\n              {{ $t('form.permDeleteWarning') }}\n            </p>\n          </div>\n          <p v-if=\"!loading && !deleting && !deleted\">\n            {{ $t('form.account_areYouSure_js', {'name': this.accountName}) }}\n          </p>\n          <p v-if=\"!loading && !deleting && !deleted\">\n            <span v-if=\"piggyBankCount > 0\">\n              {{ $tc('form.also_delete_piggyBanks_js', piggyBankCount, {count: piggyBankCount}) }}\n            </span>\n            <span v-if=\"transactionCount > 0\">\n              {{ $tc('form.also_delete_transactions_js', transactionCount, {count: transactionCount}) }}\n            </span>\n          </p>\n          <p v-if=\"transactionCount > 0 && !deleting && !deleted\">\n            {{ $tc('firefly.save_transactions_by_moving_js', transactionCount) }}\n          </p>\n          <p v-if=\"transactionCount > 0 && !deleting && !deleted\">\n            <select name=\"account\" v-model=\"moveToAccount\" class=\"form-control\">\n              <option :label=\"$t('firefly.none_in_select_list')\" :value=\"0\">{{ $t('firefly.none_in_select_list') }}</option>\n              <option v-for=\"account in accounts\" :label=\"account.name\" :value=\"account.id\">{{ account.name }}</option>\n            </select>\n          </p>\n\n          <p v-if=\"loading || deleting || deleted\" class=\"text-center\">\n            <span class=\"fas fa-spinner fa-spin\"></span>\n          </p>\n\n        </div>\n        <div class=\"card-footer\">\n          <button @click=\"deleteAccount\" class=\"btn btn-danger float-right\" v-if=\"!loading && !deleting && !deleted\"> {{\n              $t('firefly.delete_account')\n            }}\n          </button>\n        </div>\n      </div>\n\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: \"Delete\",\n  data() {\n    return {\n      loading: true,\n      deleting: false,\n      deleted: false,\n      accountId: 0,\n      accountName: '',\n      piggyBankCount: 0,\n      transactionCount: 0,\n      moveToAccount: 0,\n      accounts: []\n    }\n  },\n  created() {\n    let pathName = window.location.pathname;\n    // console.log(pathName);\n    let parts = pathName.split('/');\n    this.accountId = parseInt(parts[parts.length - 1]);\n    this.getAccount();\n  },\n  methods: {\n    deleteAccount: function () {\n      this.deleting = true;\n      if (0 === this.moveToAccount) {\n        this.execDeleteAccount();\n      }\n      if (0 !== this.moveToAccount) {\n        // move to another account:\n        this.moveTransactions();\n      }\n    },\n    moveTransactions: function () {\n      axios.post('./api/v1/data/bulk/accounts/transactions', {original_account: this.accountId, destination_account: this.moveToAccount}).then(response => {\n        this.execDeleteAccount();\n      });\n    },\n    execDeleteAccount: function () {\n      axios.delete('./api/v1/accounts/' + this.accountId)\n          .then(response => {\n            this.deleted = true;\n            this.deleting = false;\n            window.location.href = (window.previousURL ?? '/') + '?account_id=' + this.accountId + '&message=deleted';\n          });\n    },\n    getAccount: function () {\n      axios.get('./api/v1/accounts/' + this.accountId)\n          .then(response => {\n                  let account = response.data.data;\n                  this.accountName = account.attributes.name;\n                  // now get piggy and transaction count\n                  this.getPiggyBankCount(account.attributes.type, account.attributes.currency_code);\n                }\n          );\n    },\n    getAccounts: function (type, currencyCode) {\n      axios.get('./api/v1/accounts?type=' + type)\n          .then(response => {\n                  let accounts = response.data.data;\n                  for (let i in accounts) {\n                    if (accounts.hasOwnProperty(i) && /^0$|^[1-9]\\d*$/.test(i) && i <= 4294967294) {\n                      let current = accounts[i];\n                      if (false === current.attributes.active) {\n                        continue;\n                      }\n                      if (currencyCode !== current.attributes.currency_code) {\n                        continue;\n                      }\n                      if (this.accountId === parseInt(current.id)) {\n                        continue;\n                      }\n                      this.accounts.push({id: current.id, name: current.attributes.name});\n                    }\n                  }\n                  this.loading = false;\n                }\n          );\n      // get accounts of the same type.\n      // console.log('Go for \"' + type + '\"');\n    },\n    getPiggyBankCount: function (type, currencyCode) {\n      axios.get('./api/v1/accounts/' + this.accountId + '/piggy_banks')\n          .then(response => {\n                  this.piggyBankCount = response.data.meta.pagination.total ? parseInt(response.data.meta.pagination.total) : 0;\n                  this.getTransactionCount(type, currencyCode);\n                }\n          );\n    },\n    getTransactionCount: function (type, currencyCode) {\n      axios.get('./api/v1/accounts/' + this.accountId + '/transactions')\n          .then(response => {\n                  this.transactionCount = response.data.meta.pagination.total ? parseInt(response.data.meta.pagination.total) : 0;\n                  if (this.transactionCount > 0) {\n                    this.getAccounts(type, currencyCode);\n                  }\n                  if (0 === this.transactionCount) {\n                    this.loading = false;\n                  }\n                }\n          );\n    }\n  }\n}\n</script>\n\n","import { render } from \"./Delete.vue?vue&type=template&id=a5464ca4\"\nimport script from \"./Delete.vue?vue&type=script&lang=js\"\nexport * from \"./Delete.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","/*\n * index.js\n * Copyright (c) 2020 james@firefly-iii.org\n *\n * This file is part of Firefly III (https://github.com/firefly-iii).\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program.  If not, see <https://www.gnu.org/licenses/>.\n */\n\n\nrequire('../../bootstrap');\n\nimport Delete from \"../../components/accounts/Delete\";\n\n// i18n\nlet i18n = require('../../i18n');\n\n// get page name?\n\n\nlet props = {\n\n};\nnew Vue({\n            i18n,\n            render(createElement) {\n                return createElement(Delete, {props: props});\n            }\n        }).$mount('#accounts_delete');\n"],"sourceRoot":""}