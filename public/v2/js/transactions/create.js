(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{230:function(t,e,n){var s=n(410);"string"==typeof s&&(s=[[t.i,s,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(22)(s,i);s.locals&&(t.exports=s.locals)},299:function(t,e,n){t.exports=n(421)},409:function(t,e,n){"use strict";n(230)},410:function(t,e,n){(t.exports=n(21)(!1)).push([t.i,".vue-tags-input{max-width:100%!important;display:block}.ti-input,.vue-tags-input{width:100%;border-radius:.25rem}.ti-input{max-width:100%}.ti-new-tag-input{font-size:1rem}",""])},421:function(t,e,n){"use strict";n.r(e);var s=n(16),i=n(2),a={name:"Alert",props:["message","type"]},r=n(1),o=Object(r.a)(a,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.message.length>0?n("div",{class:"alert alert-"+t.type+" alert-dismissible"},[n("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"alert","aria-hidden":"true"}},[t._v("×")]),t._v(" "),n("h5",["danger"===t.type?n("i",{staticClass:"icon fas fa-ban"}):t._e(),t._v(" "),"success"===t.type?n("i",{staticClass:"icon fas fa-thumbs-up"}):t._e(),t._v(" "),"danger"===t.type?n("span",[t._v(t._s(t.$t("firefly.flash_error")))]):t._e(),t._v(" "),"success"===t.type?n("span",[t._v(t._s(t.$t("firefly.flash_success")))]):t._e()]),t._v(" "),n("span",{domProps:{innerHTML:t._s(t.message)}})]):t._e()}),[],!1,null,null,null).exports,c={name:"SplitPills",props:["transactions"]},l=Object(r.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.transactions.length>1?n("div",{staticClass:"row"},[n("div",{staticClass:"col"},[n("ul",{staticClass:"nav nav-pills ml-auto p-2"},t._l(this.transactions,(function(e,s){return n("li",{staticClass:"nav-item"},[n("a",{class:"nav-link"+(0===s?" active":""),attrs:{href:"#split_"+s,"data-toggle":"tab"}},[""!==e.description?n("span",[t._v(t._s(e.description))]):t._e(),t._v(" "),""===e.description?n("span",[t._v("Split "+t._s(s+1))]):t._e()])])})),0)])]):t._e()}),[],!1,null,null,null).exports,u=n(12),d=n(11);function p(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,s)}return n}function f(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?p(Object(n),!0).forEach((function(e){m(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function m(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var h=Object(i.b)("transactions/create"),_=(h.mapState,h.mapGetters),v=(h.mapActions,h.mapMutations),g={props:["value","errors"],name:"TransactionGroupTitle",components:{VueTypeaheadBootstrap:u.a},data:function(){return{descriptions:[],initialSet:[],title:this.value}},created:function(){var t=this;axios.get(this.getACURL("")).then((function(e){t.descriptions=e.data,t.initialSet=e.data}))},watch:{title:function(t){this.setGroupTitle({groupTitle:t})}},methods:f(f(f({},v(["setGroupTitle"])),_(["groupTitle"])),{},{clearDescription:function(){this.setGroupTitle({groupTitle:""}),this.title=""},getACURL:function(t){return document.getElementsByTagName("base")[0].href+"api/v1/autocomplete/transactions?query="+t},lookupDescription:Object(d.debounce)((function(){var t=this;axios.get(this.getACURL(this.title)).then((function(e){t.descriptions=e.data}))}),300)})},y=Object(r.a)(g,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"form-group"},[n("div",{staticClass:"text-xs d-none d-lg-block d-xl-block"},[t._v("\n    "+t._s(t.$t("firefly.split_transaction_title"))+"\n  ")]),t._v(" "),n("vue-typeahead-bootstrap",{attrs:{inputName:"group_title",data:t.descriptions,placeholder:t.$t("firefly.split_transaction_title"),showOnFocus:!0,minMatchingChars:3,serializer:function(t){return t.description},inputClass:t.errors.length>0?"is-invalid":""},on:{input:t.lookupDescription},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}},[n("template",{slot:"append"},[n("div",{staticClass:"input-group-append"},[n("button",{staticClass:"btn btn-outline-secondary",attrs:{tabindex:"-1",type:"button"},on:{click:t.clearDescription}},[n("i",{staticClass:"far fa-trash-alt"})])])])],2),t._v(" "),t.errors.length>0?n("span",t._l(t.errors,(function(e){return n("span",{staticClass:"text-danger small"},[t._v(t._s(e)),n("br")])})),0):t._e()],1)}),[],!1,null,"20a0ca60",null).exports,b={props:["index","value","errors"],components:{VueTypeaheadBootstrap:u.a},name:"TransactionDescription",data:function(){return{descriptions:[],initialSet:[],description:this.value}},created:function(){var t=this;axios.get(this.getACURL("")).then((function(e){t.descriptions=e.data,t.initialSet=e.data}))},methods:{clearDescription:function(){this.description=""},getACURL:function(t){return document.getElementsByTagName("base")[0].href+"api/v1/autocomplete/transactions?query="+t},lookupDescription:Object(d.debounce)((function(){var t=this;axios.get(this.getACURL(this.value)).then((function(e){t.descriptions=e.data}))}),300)},watch:{description:function(t){this.$emit("set-description",t)}}},x=Object(r.a)(b,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"form-group"},[n("vue-typeahead-bootstrap",{attrs:{inputName:"description[]",data:t.descriptions,placeholder:t.$t("firefly.description"),showOnFocus:!0,autofocus:"",inputClass:t.errors.length>0?"is-invalid":"",minMatchingChars:3,serializer:function(t){return t.description}},on:{input:t.lookupDescription},model:{value:t.description,callback:function(e){t.description=e},expression:"description"}},[n("template",{slot:"append"},[n("div",{staticClass:"input-group-append"},[n("button",{staticClass:"btn btn-outline-secondary",attrs:{tabindex:"-1",type:"button"},on:{click:t.clearDescription}},[n("i",{staticClass:"far fa-trash-alt"})])])])],2),t._v(" "),t.errors.length>0?n("span",t._l(t.errors,(function(e){return n("span",{staticClass:"text-danger small"},[t._v(t._s(e)),n("br")])})),0):t._e()],1)}),[],!1,null,null,null).exports,C={props:["index","errors","date","time"],name:"TransactionDate",data:function(){return{localDate:this.date,localTime:this.time}},methods:{},computed:{dateStr:{get:function(){return this.localDate instanceof Date&&!isNaN(this.localDate)?this.localDate.toISOString().split("T")[0]:""},set:function(t){if(""===t)return this.localDate=new Date,void this.$emit("set-date",{date:this.localDate});this.localDate=new Date(t),this.$emit("set-date",{date:this.localDate})}},timeStr:{get:function(){return this.localTime instanceof Date&&!isNaN(this.localTime)?("0"+this.localTime.getHours()).slice(-2)+":"+("0"+this.localTime.getMinutes()).slice(-2)+":"+("0"+this.localTime.getSeconds()).slice(-2):""},set:function(t){if(""===t)return this.localTime.setHours(0),this.localTime.setMinutes(0),this.localTime.setSeconds(0),void this.$emit("set-time",{time:this.localTime});var e=new Date(this.localTime.getTime()),n=t.split(":");e.setHours(parseInt(n[0])),e.setMinutes(parseInt(n[1])),e.setSeconds(parseInt(n[2])),this.localTime=e,this.$emit("set-time",{time:this.localTime})}}}},T=Object(r.a)(C,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"form-group"},[n("div",{staticClass:"text-xs d-none d-lg-block d-xl-block"},[t._v("\n    "+t._s(t.$t("firefly.date_and_time"))+"\n  ")]),t._v(" "),n("div",{staticClass:"input-group"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.dateStr,expression:"dateStr"}],ref:"date",class:t.errors.length>0?"form-control is-invalid":"form-control",attrs:{type:"date",title:t.$t("firefly.date"),disabled:t.index>0,autocomplete:"off",name:"date[]",placeholder:t.dateStr},domProps:{value:t.dateStr},on:{input:function(e){e.target.composing||(t.dateStr=e.target.value)}}}),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.timeStr,expression:"timeStr"}],ref:"time",class:t.errors.length>0?"form-control is-invalid":"form-control",attrs:{type:"time",title:t.$t("firefly.time"),disabled:t.index>0,autocomplete:"off",name:"time[]",placeholder:t.timeStr},domProps:{value:t.timeStr},on:{input:function(e){e.target.composing||(t.timeStr=e.target.value)}}})]),t._v(" "),t.errors.length>0?n("span",t._l(t.errors,(function(e){return n("span",{staticClass:"text-danger small"},[t._v(t._s(e)),n("br")])})),0):t._e()])}),[],!1,null,null,null).exports,k={props:["index","value","errors"],name:"TransactionBudget",data:function(){return{budgetList:[],budget:this.value}},created:function(){this.collectData()},methods:{collectData:function(){this.budgetList.push({id:0,name:this.$t("firefly.no_budget")}),this.getBudgets()},getBudgets:function(){var t=this;axios.get("./api/v1/budgets").then((function(e){t.parseBudgets(e.data)}))},parseBudgets:function(t){for(var e in t.data)if(t.data.hasOwnProperty(e)&&/^0$|^[1-9]\d*$/.test(e)&&e<=4294967294){var n=t.data[e];this.budgetList.push({id:parseInt(n.id),name:n.attributes.name})}}},watch:{budget:function(t){this.$emit("set-budget",t)}}},w=Object(r.a)(k,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"form-group"},[n("div",{staticClass:"text-xs d-none d-lg-block d-xl-block"},[t._v("\n    "+t._s(t.$t("firefly.budget"))+"\n  ")]),t._v(" "),n("div",{staticClass:"input-group"},[n("select",{directives:[{name:"model",rawName:"v-model",value:t.budget,expression:"budget"}],ref:"budget",class:t.errors.length>0?"form-control is-invalid":"form-control",attrs:{title:t.$t("firefly.budget"),autocomplete:"off",name:"budget_id[]"},on:{submit:function(t){t.preventDefault()},change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.budget=e.target.multiple?n:n[0]}}},t._l(this.budgetList,(function(e){return n("option",{attrs:{label:e.name},domProps:{value:e.id}},[t._v(t._s(e.name))])})),0)]),t._v(" "),t.errors.length>0?n("span",t._l(t.errors,(function(e){return n("span",{staticClass:"text-danger small"},[t._v(t._s(e)),n("br")])})),0):t._e()])}),[],!1,null,null,null).exports;function $(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,s)}return n}function F(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?$(Object(n),!0).forEach((function(e){A(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function A(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var O=Object(i.b)("transactions/create"),j=(O.mapState,O.mapGetters),S=(O.mapActions,O.mapMutations),P={name:"TransactionAccount",components:{VueTypeaheadBootstrap:u.a},props:["index","direction","value","errors"],data:function(){return{query:"",accounts:[],accountTypes:[],initialSet:[],selectedAccount:{},account:this.value,accountName:"",selectedAccountTrigger:!1}},created:function(){this.createInitialSet()},methods:F(F({},S(["updateField","setDestinationAllowedTypes","setSourceAllowedTypes"])),{},{getACURL:function(t,e){return"./api/v1/autocomplete/accounts?types="+t.join(",")+"&query="+e},clearAccount:function(){this.accounts=this.initialSet,this.account={name:"",type:"no_type",id:null,currency_id:null,currency_code:null,currency_symbol:null},this.accountName=""},lookupAccount:Object(d.debounce)((function(){var t=this;0===this.accountTypes.length&&(this.accountTypes="source"===this.direction?this.sourceAllowedTypes:this.destinationAllowedTypes),axios.get(this.getACURL(this.accountTypes,this.accountName)).then((function(e){t.accounts=e.data}))}),300),createInitialSet:function(){var t=this,e=this.sourceAllowedTypes;"destination"===this.direction&&(e=this.destinationAllowedTypes),axios.get(this.getACURL(e,"")).then((function(e){t.accounts=e.data,t.initialSet=e.data}))}}),watch:{selectedAccount:function(t){this.selectedAccountTrigger=!0,this.account=t,this.$emit(this.emitAccountId,t.id),this.$emit(this.emitAccountType,t.type),this.$emit(this.emitAccountName,t.name),this.$emit(this.emitAccountCurrencyId,t.currency_id),this.$emit(this.emitAccountCurrencyCode,t.currency_code),this.$emit(this.emitAccountCurrencySymbol,t.currency_symbol),this.accountName=this.account.name_with_balance},accountName:function(t){!1===this.selectedAccountTrigger&&(console.log("Save to change name!"),this.$emit(this.emitAccountId,null),this.$emit(this.emitAccountType,null),this.$emit(this.emitAccountName,t),this.$emit(this.emitAccountCurrencyId,null),this.$emit(this.emitAccountCurrencyCode,null),this.$emit(this.emitAccountCurrencySymbol,null),this.accountTrigger=!1,this.account={name:t,type:null,id:null,currency_id:null,currency_code:null,currency_symbol:null}),this.selectedAccountTrigger=!1},account:function(t){var e=[],n=t.type?t.type:"no_type";void 0!==this.allowedOpposingTypes[this.direction]&&void 0!==this.allowedOpposingTypes[this.direction][n]&&(e=this.allowedOpposingTypes[this.direction][n]),"source"===this.direction&&this.setDestinationAllowedTypes(e),"destination"===this.direction&&this.setSourceAllowedTypes(e)},value:function(t){console.log(this.direction+" account overruled by external forces."),this.account=t,this.selectedAccountTrigger=!0,this.accountName=t.name}},computed:F(F({},j(["transactionType","sourceAllowedTypes","destinationAllowedTypes","allowedOpposingTypes"])),{},{accountKey:{get:function(){return"source"===this.direction?"source_account":"destination_account"}},emitAccountId:{get:function(){return"set-"+this.direction+"-account-id"}},emitAccount:{get:function(){return"set-"+this.direction+"-account"}},emitAccountName:{get:function(){return"set-"+this.direction+"-account-name"}},emitAccountType:{get:function(){return"set-"+this.direction+"-account-type"}},emitAccountCurrencyId:{get:function(){return"set-"+this.direction+"-account-currency-id"}},emitAccountCurrencyCode:{get:function(){return"set-"+this.direction+"-account-currency-code"}},emitAccountCurrencySymbol:{get:function(){return"set-"+this.direction+"-account-currency-symbol"}},visible:{get:function(){return 0===this.index||("source"===this.direction?"any"===this.transactionType||"Deposit"===this.transactionType:"destination"===this.direction&&("any"===this.transactionType||"Withdrawal"===this.transactionType))}}})},D=Object(r.a)(P,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"form-group"},[t.visible?n("div",{staticClass:"text-xs d-none d-lg-block d-xl-block"},[0===this.index?n("span",[t._v(t._s(t.$t("firefly."+this.direction+"_account")))]):t._e(),t._v(" "),this.index>0?n("span",{staticClass:"text-warning"},[t._v(t._s(t.$t("firefly.first_split_overrules_"+this.direction)))]):t._e()]):t._e(),t._v(" "),t.visible?t._e():n("div",{staticClass:"text-xs d-none d-lg-block d-xl-block"},[t._v("\n     \n  ")]),t._v(" "),t.visible?n("vue-typeahead-bootstrap",{attrs:{data:t.accounts,showOnFocus:!0,inputClass:t.errors.length>0?"is-invalid":"",inputName:t.direction+"[]",serializer:function(t){return t.name_with_balance},minMatchingChars:3,placeholder:t.$t("firefly."+t.direction+"_account")},on:{input:t.lookupAccount,hit:function(e){t.selectedAccount=e}},scopedSlots:t._u([{key:"suggestion",fn:function(e){var s=e.data,i=e.htmlText;return[n("div",{staticClass:"d-flex",attrs:{title:s.type}},[n("span",{domProps:{innerHTML:t._s(i)}}),n("br")])]}}],null,!1,1423807661),model:{value:t.accountName,callback:function(e){t.accountName=e},expression:"accountName"}},[t._v(" "),n("template",{slot:"append"},[n("div",{staticClass:"input-group-append"},[n("button",{staticClass:"btn btn-outline-secondary",attrs:{tabindex:"-1",type:"button"},on:{click:t.clearAccount}},[n("i",{staticClass:"far fa-trash-alt"})])])])],2):t._e(),t._v(" "),t.visible?t._e():n("div",{staticClass:"form-control-static"},[n("span",{staticClass:"small text-muted"},[n("em",[t._v(t._s(t.$t("firefly.first_split_decides")))])])]),t._v(" "),t.errors.length>0?n("span",t._l(t.errors,(function(e){return n("span",{staticClass:"text-danger small"},[t._v(t._s(e)),n("br")])})),0):t._e()],1)}),[],!1,null,null,null).exports;function E(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,s)}return n}function L(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?E(Object(n),!0).forEach((function(e){I(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function I(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var N=Object(i.b)("transactions/create"),M=(N.mapState,N.mapGetters),U=(N.mapActions,{name:"SwitchAccount",props:["index"],methods:L(L({},(0,N.mapMutations)(["updateField"])),{},{switchAccounts:function(){this.$emit("switch-accounts",this.index)}}),computed:L({},M(["transactionType"]))}),R=Object(r.a)(U,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"form-group"},[n("div",{staticClass:"text-xs d-none d-lg-block d-xl-block"},["any"!==this.transactionType?n("span",{staticClass:"text-muted"},[t._v("\n      "+t._s(t.$t("firefly."+this.transactionType))+"\n    ")]):t._e(),t._v(" "),"any"===this.transactionType?n("span",{staticClass:"text-muted"},[t._v(" ")]):t._e()]),t._v(" "),n("div",{staticClass:"btn-group d-flex"},[n("button",{staticClass:"btn btn-light",on:{click:t.switchAccounts}},[t._v("↔")])])])}),[],!1,null,"2d362d12",null).exports,B={name:"TransactionAmount",props:["index","errors","amount","transactionType","sourceCurrencySymbol","destinationCurrencySymbol"],data:function(){return{transactionAmount:this.amount,currencySymbol:null,srcCurrencySymbol:this.sourceCurrencySymbol,dstCurrencySymbol:this.destinationCurrencySymbol}},watch:{transactionAmount:function(t){this.$emit("set-amount",t)},amount:function(t){this.transactionAmount=t},sourceCurrencySymbol:function(t){this.srcCurrencySymbol=t},destinationCurrencySymbol:function(t){this.dstCurrencySymbol=t},transactionType:function(t){switch(t){case"Transfer":case"Withdrawal":this.currencySymbol=this.srcCurrencySymbol;break;case"Deposit":this.currencySymbol=this.dstCurrencySymbol}}}},z=Object(r.a)(B,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"form-group"},[n("div",{staticClass:"text-xs"},[t._v(t._s(t.$t("firefly.amount")))]),t._v(" "),n("div",{staticClass:"input-group"},[t.currencySymbol?n("div",{staticClass:"input-group-prepend"},[n("div",{staticClass:"input-group-text"},[t._v(t._s(t.currencySymbol))])]):t._e(),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.transactionAmount,expression:"transactionAmount"}],class:t.errors.length>0?"form-control is-invalid":"form-control",attrs:{title:t.$t("firefly.amount"),autocomplete:"off",name:"amount[]",type:"number",placeholder:t.$t("firefly.amount")},domProps:{value:t.transactionAmount},on:{input:function(e){e.target.composing||(t.transactionAmount=e.target.value)}}})]),t._v(" "),t.errors.length>0?n("span",t._l(t.errors,(function(e){return n("span",{staticClass:"text-danger small"},[t._v(t._s(e)),n("br")])})),0):t._e()])}),[],!1,null,"71a072b0",null).exports,V={name:"TransactionForeignAmount",props:["index","errors","transactionType","sourceCurrencyId","destinationCurrencyId"],data:function(){return{amount:""}},watch:{amount:function(t){this.$emit("set-foreign-amount",t)}},computed:{isVisible:{get:function(){return!("Transfer"===this.transactionType&&this.sourceCurrencyId===this.destinationCurrencyId)}}}},G=Object(r.a)(V,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.isVisible?n("div",{staticClass:"form-group"},[n("div",{staticClass:"text-xs"},[t._v(t._s(t.$t("form.foreign_amount")))]),t._v(" "),n("div",{staticClass:"input-group"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.amount,expression:"amount"}],class:t.errors.length>0?"form-control is-invalid":"form-control",attrs:{title:t.$t("form.foreign_amount"),autocomplete:"off",name:"foreign_amount[]",type:"number",placeholder:t.$t("form.foreign_amount")},domProps:{value:t.amount},on:{input:function(e){e.target.composing||(t.amount=e.target.value)}}})]),t._v(" "),t.errors.length>0?n("span",t._l(t.errors,(function(e){return n("span",{staticClass:"text-danger small"},[t._v(t._s(e)),n("br")])})),0):t._e()]):t._e()}),[],!1,null,"1439811f",null).exports,q={name:"TransactionForeignCurrency",props:["index","transactionType","sourceCurrencyId","destinationCurrencyId","selectedCurrencyId"],data:function(){return{selectedCurrency:0,allCurrencies:[],selectableCurrencies:[],dstCurrencyId:this.destinationCurrencyId,srcCurrencyId:this.sourceCurrencyId,lockedCurrency:0}},watch:{sourceCurrencyId:function(t){this.srcCurrencyId=t},destinationCurrencyId:function(t){this.dstCurrencyId=t},selectedCurrency:function(t){this.$emit("set-foreign-currency-id",t)},transactionType:function(t){this.lockedCurrency=0,"Transfer"===t&&(this.lockedCurrency=this.dstCurrencyId,this.selectedCurrency=this.dstCurrencyId),this.filterCurrencies()}},created:function(){this.getAllCurrencies()},methods:{getAllCurrencies:function(){var t=this;axios.get("./api/v1/autocomplete/currencies").then((function(e){t.allCurrencies=e.data,t.filterCurrencies()}))},filterCurrencies:function(){if(0===this.lockedCurrency){for(var t in this.selectableCurrencies=[{id:0,name:this.$t("firefly.no_currency")}],this.allCurrencies)if(this.allCurrencies.hasOwnProperty(t)&&/^0$|^[1-9]\d*$/.test(t)&&t<=4294967294){var e=this.allCurrencies[t];this.selectableCurrencies.push(e)}}else for(var n in this.allCurrencies)if(this.allCurrencies.hasOwnProperty(n)&&/^0$|^[1-9]\d*$/.test(n)&&n<=4294967294){var s=this.allCurrencies[n];s.id===this.lockedCurrency&&(this.selectableCurrencies=[s],this.selectedCurrency=s.id)}}},computed:{isVisible:function(){return!("Transfer"===this.transactionType&&this.srcCurrencyId===this.dstCurrencyId)}}},H=Object(r.a)(q,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.isVisible?n("div",{staticClass:"form-group"},[n("div",{staticClass:"text-xs"},[t._v(" ")]),t._v(" "),n("div",{staticClass:"input-group"},[n("select",{directives:[{name:"model",rawName:"v-model",value:t.selectedCurrency,expression:"selectedCurrency"}],staticClass:"form-control",attrs:{name:"foreign_currency_id[]"},on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.selectedCurrency=e.target.multiple?n:n[0]}}},t._l(t.selectableCurrencies,(function(e){return n("option",{attrs:{label:e.name},domProps:{value:e.id}},[t._v(t._s(e.name))])})),0)])]):t._e()}),[],!1,null,"5af5a995",null).exports,W={name:"TransactionCustomDates",props:["index","errors","customFields","interestDate","bookDate","processDate","dueDate","paymentDate","invoiceDate"],data:function(){return{dateFields:["interest_date","book_date","process_date","due_date","payment_date","invoice_date"],availableFields:this.customFields,dates:{interest_date:this.interestDate,book_date:this.bookDate,process_date:this.processDate,due_date:this.dueDate,payment_date:this.paymentDate,invoice_date:this.invoiceDate}}},watch:{customFields:function(t){this.availableFields=t}},methods:{isDateField:function(t){return this.dateFields.includes(t)},getFieldValue:function(t){var e;return null!==(e=this.dates[t])&&void 0!==e?e:""},setFieldValue:function(t,e){this.$emit("set-custom-date",{field:e,date:t.target.value})}}},J=Object(r.a)(W,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",t._l(t.availableFields,(function(e,s){return n("div",{staticClass:"form-group"},[e&&t.isDateField(s)?n("div",{staticClass:"text-xs d-none d-lg-block d-xl-block"},[t._v("\n      "+t._s(t.$t("form."+s))+"\n    ")]):t._e(),t._v(" "),e&&t.isDateField(s)?n("div",{staticClass:"input-group"},[n("input",{ref:s,refInFor:!0,staticClass:"form-control",attrs:{type:"date",title:t.$t("form."+s),autocomplete:"off",name:s+"[]",placeholder:t.$t("form."+s)},domProps:{value:t.getFieldValue(s)},on:{change:function(e){return t.setFieldValue(e,s)},submit:function(t){t.preventDefault()}}})]):t._e()])})),0)}),[],!1,null,null,null).exports,K={props:["value","index","errors"],components:{VueTypeaheadBootstrap:u.a},name:"TransactionCategory",data:function(){return{categories:[],initialSet:[],category:this.value}},created:function(){var t=this;axios.get(this.getACURL("")).then((function(e){t.categories=e.data,t.initialSet=e.data}))},methods:{clearCategory:function(){this.category=null},getACURL:function(t){return document.getElementsByTagName("base")[0].href+"api/v1/autocomplete/categories?query="+t},lookupCategory:Object(d.debounce)((function(){var t=this;axios.get(this.getACURL(this.value)).then((function(e){t.categories=e.data}))}),300)},watch:{category:function(t){this.$emit("set-category",t)}},computed:{selectedCategory:{get:function(){return this.categories[this.index].name},set:function(t){this.category=t.name}}}},Z=Object(r.a)(K,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"form-group"},[n("div",{staticClass:"text-xs d-none d-lg-block d-xl-block"},[t._v("\n    "+t._s(t.$t("firefly.category"))+"\n  ")]),t._v(" "),n("vue-typeahead-bootstrap",{attrs:{inputName:"category[]",data:t.categories,placeholder:t.$t("firefly.category"),showOnFocus:!0,inputClass:t.errors.length>0?"is-invalid":"",minMatchingChars:3,serializer:function(t){return t.name}},on:{hit:function(e){t.selectedCategory=e},input:t.lookupCategory},model:{value:t.category,callback:function(e){t.category=e},expression:"category"}},[n("template",{slot:"append"},[n("div",{staticClass:"input-group-append"},[n("button",{staticClass:"btn btn-outline-secondary",attrs:{tabindex:"-1",type:"button"},on:{click:t.clearCategory}},[n("i",{staticClass:"far fa-trash-alt"})])])])],2),t._v(" "),t.errors.length>0?n("span",t._l(t.errors,(function(e){return n("span",{staticClass:"text-danger small"},[t._v(t._s(e)),n("br")])})),0):t._e()],1)}),[],!1,null,null,null).exports,Y={props:["value","index","errors"],name:"TransactionBill",data:function(){return{billList:[],bill:this.value}},created:function(){this.collectData()},methods:{collectData:function(){this.billList.push({id:0,name:this.$t("firefly.no_bill")}),this.getBills()},getBills:function(){var t=this;axios.get("./api/v1/bills").then((function(e){t.parseBills(e.data)}))},parseBills:function(t){for(var e in t.data)if(t.data.hasOwnProperty(e)&&/^0$|^[1-9]\d*$/.test(e)&&e<=4294967294){var n=t.data[e];this.billList.push({id:parseInt(n.id),name:n.attributes.name})}}},watch:{bill:function(t){this.$emit("set-bill",t)}}},Q=Object(r.a)(Y,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"form-group"},[n("div",{staticClass:"text-xs d-none d-lg-block d-xl-block"},[t._v("\n    "+t._s(t.$t("firefly.bill"))+"\n  ")]),t._v(" "),n("div",{staticClass:"input-group"},[n("select",{directives:[{name:"model",rawName:"v-model",value:t.bill,expression:"bill"}],ref:"bill",class:t.errors.length>0?"form-control is-invalid":"form-control",attrs:{title:t.$t("firefly.bill"),autocomplete:"off",name:"bill_id[]"},on:{submit:function(t){t.preventDefault()},change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.bill=e.target.multiple?n:n[0]}}},t._l(this.billList,(function(e){return n("option",{attrs:{label:e.name},domProps:{value:e.id}},[t._v(t._s(e.name))])})),0)]),t._v(" "),t.errors.length>0?n("span",t._l(t.errors,(function(e){return n("span",{staticClass:"text-danger small"},[t._v(t._s(e)),n("br")])})),0):t._e()])}),[],!1,null,null,null).exports,X=n(239),tt=n.n(X),et=n(50),nt=n.n(et),st={name:"TransactionTags",components:{VueTagsInput:tt.a},props:["value","index","errors"],data:function(){return{autocompleteItems:[],debounce:null,tags:[],currentTag:"",updateTags:!0,tagList:this.value}},watch:{currentTag:"initItems",tagList:function(t){this.$emit("set-tags",t),this.updateTags=!1,this.tags=t},tags:function(t){if(this.updateTags){var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push({text:t[n].text});this.tagList=e}this.updateTags=!0}},methods:{initItems:function(){var t=this;if(!(this.currentTag.length<2)){var e=document.getElementsByTagName("base")[0].href+"api/v1/autocomplete/tags?query=".concat(this.currentTag);clearTimeout(this.debounce),this.debounce=setTimeout((function(){nt.a.get(e).then((function(e){t.autocompleteItems=e.data.map((function(t){return{text:t.tag}}))})).catch((function(){return console.warn("Oh. Something went wrong loading tags.")}))}),300)}}}},it=(n(409),Object(r.a)(st,(function(){var t=this,e=this,n=e.$createElement,s=e._self._c||n;return s("div",{staticClass:"form-group"},[s("div",{staticClass:"text-xs d-none d-lg-block d-xl-block"},[e._v("\n    "+e._s(e.$t("firefly.tags"))+"\n  ")]),e._v(" "),s("div",{staticClass:"input-group"},[s("vue-tags-input",{attrs:{"add-only-from-autocomplete":!1,"autocomplete-items":e.autocompleteItems,tags:e.tags,title:e.$t("firefly.tags"),placeholder:e.$t("firefly.tags")},on:{"tags-changed":function(e){return t.tags=e}},model:{value:e.currentTag,callback:function(t){e.currentTag=t},expression:"currentTag"}})],1),e._v(" "),e.errors.length>0?s("span",e._l(e.errors,(function(t){return s("span",{staticClass:"text-danger small"},[e._v(e._s(t)),s("br")])})),0):e._e()])}),[],!1,null,null,null).exports),at={props:["index","value","errors"],name:"TransactionPiggyBank",data:function(){return{piggyList:[],piggy_bank_id:this.value}},created:function(){this.collectData()},methods:{collectData:function(){this.piggyList.push({id:0,name_with_balance:this.$t("firefly.no_piggy_bank")}),this.getPiggies()},getPiggies:function(){var t=this;axios.get("./api/v1/autocomplete/piggy-banks-with-balance").then((function(e){t.parsePiggies(e.data)}))},parsePiggies:function(t){for(var e in t)if(t.hasOwnProperty(e)&&/^0$|^[1-9]\d*$/.test(e)&&e<=4294967294){var n=t[e];this.piggyList.push({id:parseInt(n.id),name_with_balance:n.name_with_balance})}}},watch:{piggy_bank_id:function(t){this.$emit("set-piggy-bank",t)}}},rt=Object(r.a)(at,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"form-group"},[n("div",{staticClass:"text-xs d-none d-lg-block d-xl-block"},[t._v("\n    "+t._s(t.$t("firefly.piggy_bank"))+"\n  ")]),t._v(" "),n("div",{staticClass:"input-group"},[n("select",{directives:[{name:"model",rawName:"v-model",value:t.piggy_bank_id,expression:"piggy_bank_id"}],ref:"piggy_bank_id",class:t.errors.length>0?"form-control is-invalid":"form-control",attrs:{title:t.$t("firefly.piggy_bank"),autocomplete:"off",name:"piggy_bank_id[]"},on:{submit:function(t){t.preventDefault()},change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.piggy_bank_id=e.target.multiple?n:n[0]}}},t._l(this.piggyList,(function(e){return n("option",{attrs:{label:e.name_with_balance},domProps:{value:e.id}},[t._v(t._s(e.name_with_balance))])})),0)]),t._v(" "),t.errors.length>0?n("span",t._l(t.errors,(function(e){return n("span",{staticClass:"text-danger small"},[t._v(t._s(e)),n("br")])})),0):t._e()])}),[],!1,null,null,null).exports,ot={props:["index","value","errors","customFields"],name:"TransactionInternalReference",data:function(){return{reference:this.value,availableFields:this.customFields}},computed:{showField:function(){return"internal_reference"in this.availableFields&&this.availableFields.internal_reference}},methods:{},watch:{customFields:function(t){this.availableFields=t},reference:function(t){this.$emit("set-internal-reference",t)}}},ct=Object(r.a)(ot,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.showField?n("div",{staticClass:"form-group"},[n("div",{staticClass:"text-xs d-none d-lg-block d-xl-block"},[t._v("\n    "+t._s(t.$t("firefly.internal_reference"))+"\n  ")]),t._v(" "),n("div",{staticClass:"input-group"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.reference,expression:"reference"}],class:t.errors.length>0?"form-control is-invalid":"form-control",attrs:{type:"text",name:"internal_reference[]",placeholder:t.$t("firefly.internal_reference")},domProps:{value:t.reference},on:{input:function(e){e.target.composing||(t.reference=e.target.value)}}}),t._v(" "),t._m(0)])]):t._e()}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"input-group-append"},[e("button",{staticClass:"btn btn-outline-secondary",attrs:{tabindex:"-1",type:"button"}},[e("i",{staticClass:"far fa-trash-alt"})])])}],!1,null,null,null).exports,lt={props:["index","value","errors","customFields"],name:"TransactionExternalUrl",data:function(){return{url:this.value,availableFields:this.customFields}},computed:{showField:function(){return"external_uri"in this.availableFields&&this.availableFields.external_uri}},methods:{},watch:{customFields:function(t){this.availableFields=t},url:function(t){this.$emit("set-external-url",t)}}},ut=Object(r.a)(lt,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.showField?n("div",{staticClass:"form-group"},[n("div",{staticClass:"text-xs d-none d-lg-block d-xl-block"},[t._v("\n    "+t._s(t.$t("firefly.external_url"))+"\n  ")]),t._v(" "),n("div",{staticClass:"input-group"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.url,expression:"url"}],class:t.errors.length>0?"form-control is-invalid":"form-control",attrs:{type:"url",name:"external_url[]",placeholder:t.$t("firefly.external_url")},domProps:{value:t.url},on:{input:function(e){e.target.composing||(t.url=e.target.value)}}}),t._v(" "),t._m(0)])]):t._e()}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"input-group-append"},[e("button",{staticClass:"btn btn-outline-secondary",attrs:{tabindex:"-1",type:"button"}},[e("i",{staticClass:"far fa-trash-alt"})])])}],!1,null,"630feb99",null).exports,dt={props:["index","value","errors","customFields"],name:"TransactionNotes",data:function(){return{notes:this.value,availableFields:this.customFields}},computed:{showField:function(){return"notes"in this.availableFields&&this.availableFields.notes}},watch:{customFields:function(t){this.availableFields=t},notes:function(t){this.$emit("set-notes",t)}}},pt=Object(r.a)(dt,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.showField?n("div",{staticClass:"form-group"},[n("div",{staticClass:"text-xs d-none d-lg-block d-xl-block"},[t._v("\n    "+t._s(t.$t("firefly.notes"))+"\n  ")]),t._v(" "),n("div",{staticClass:"input-group"},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.notes,expression:"notes"}],class:t.errors.length>0?"form-control is-invalid":"form-control",attrs:{placeholder:t.$t("firefly.notes")},domProps:{value:t.notes},on:{input:function(e){e.target.composing||(t.notes=e.target.value)}}})])]):t._e()}),[],!1,null,"dca081c4",null).exports,ft=n(191),mt={props:["index","value","errors","customFields"],name:"TransactionLinks",data:function(){return{searchResults:[],include:[],locale:"en-US",linkTypes:[],query:"",searching:!1,links:[],availableFields:this.customFields}},created:function(){var t;this.locale=null!==(t=localStorage.locale)&&void 0!==t?t:"en-US",this.links=ft(this.value),this.getLinkTypes()},computed:{showField:function(){return"links"in this.availableFields&&this.availableFields.links}},watch:{links:function(t){this.$emit("set-links",ft(t))},customFields:function(t){this.availableFields=t}},methods:{getTextForLinkType:function(t){var e=t.split("-");for(var n in this.linkTypes)if(this.linkTypes.hasOwnProperty(n)&&/^0$|^[1-9]\d*$/.test(n)&&n<=4294967294){var s=this.linkTypes[n];if(e[0]===s.id&&e[1]===s.direction)return s.type}return"text for #"+t},selectTransaction:function(t){for(var e in this.searchResults)if(this.searchResults.hasOwnProperty(e)&&/^0$|^[1-9]\d*$/.test(e)&&e<=4294967294){var n=this.searchResults[e];n.selected&&this.addToSelected(n),n.selected||this.removeFromSelected(n)}},selectLinkType:function(t){for(var e in this.searchResults)if(this.searchResults.hasOwnProperty(e)&&/^0$|^[1-9]\d*$/.test(e)&&e<=4294967294){var n=this.searchResults[e];this.updateSelected(n.transaction_journal_id,n.link_type_id)}},updateSelected:function(t,e){for(var n in this.links)if(this.links.hasOwnProperty(n)&&/^0$|^[1-9]\d*$/.test(n)&&n<=4294967294){var s=this.links[n];parseInt(s.transaction_journal_id)===t&&(this.links[n].link_type_id=e)}},addToSelected:function(t){void 0===this.links.find((function(e){return e.transaction_journal_id===t.transaction_journal_id}))&&this.links.push(t)},removeFromSelected:function(t){for(var e in this.links){if(this.links.hasOwnProperty(e)&&/^0$|^[1-9]\d*$/.test(e)&&e<=4294967294)this.links[e].transaction_journal_id===t.transaction_journal_id&&this.links.splice(parseInt(e),1)}},getLinkTypes:function(){var t=this;axios.get("./api/v1/link_types").then((function(e){t.parseLinkTypes(e.data)}))},parseLinkTypes:function(t){for(var e in t.data)if(t.data.hasOwnProperty(e)&&/^0$|^[1-9]\d*$/.test(e)&&e<=4294967294){var n=t.data[e],s={id:n.id,type:n.attributes.inward,direction:"inward"},i={id:n.id,type:n.attributes.outward,direction:"outward"};s.type===i.type&&(s.type=s.type+" (←)",i.type=i.type+" (→)"),this.linkTypes.push(s),this.linkTypes.push(i)}},search:function(){var t=this;this.searching=!0,this.searchResults=[];var e="./api/v1/search/transactions?limit=10&query="+this.query;axios.get(e).then((function(e){t.parseSearch(e.data)}))},parseSearch:function(t){for(var e in t.data)if(t.data.hasOwnProperty(e)&&/^0$|^[1-9]\d*$/.test(e)&&e<=4294967294)for(var n in t.data[e].attributes.transactions)if(t.data[e].attributes.transactions.hasOwnProperty(n)&&/^0$|^[1-9]\d*$/.test(n)&&n<=4294967294){var s=t.data[e].attributes.transactions[n];s.transaction_group_id=parseInt(t.data[e].id),s.selected=this.isJournalSelected(s.transaction_journal_id),s.link_type_id=this.getJournalLinkType(s.transaction_journal_id),s.link_type_text="",this.searchResults.push(s)}this.searching=!1},getJournalLinkType:function(t){for(var e in this.links)if(this.links.hasOwnProperty(e)&&/^0$|^[1-9]\d*$/.test(e)&&e<=4294967294){var n=this.links[e];if(n.transaction_journal_id===t)return n.link_type_id}return"1-inward"},isJournalSelected:function(t){for(var e in this.links){if(this.links.hasOwnProperty(e)&&/^0$|^[1-9]\d*$/.test(e)&&e<=4294967294)if(this.links[e].transaction_journal_id===t)return!0}return!1}}},ht=Object(r.a)(mt,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.showField?n("div",[n("div",{staticClass:"form-group"},[n("div",{staticClass:"text-xs d-none d-lg-block d-xl-block"},[t._v("\n      "+t._s(t.$t("firefly.journal_links"))+"\n    ")]),t._v(" "),n("div",{staticClass:"row"},[n("div",{staticClass:"col"},[0===t.links.length?n("p",[t._m(0)]):t._e(),t._v(" "),t.links.length>0?n("ul",{staticClass:"list-group"},t._l(t.links,(function(e){return n("li",{staticClass:"list-group-item"},[n("em",[t._v(t._s(t.getTextForLinkType(e.link_type_id)))]),t._v(" "),n("a",{attrs:{href:"./transaction/show/"+e.transaction_group_id}},[t._v(t._s(e.description))]),t._v(" "),"withdrawal"===e.type?n("span",[t._v("\n                        ("),n("span",{staticClass:"text-danger"},[t._v(t._s(Intl.NumberFormat(t.locale,{style:"currency",currency:e.currency_code}).format(-1*parseFloat(e.amount))))]),t._v(")\n                      ")]):t._e(),t._v(" "),"deposit"===e.type?n("span",[t._v("\n                        ("),n("span",{staticClass:"text-success"},[t._v(t._s(Intl.NumberFormat(t.locale,{style:"currency",currency:e.currency_code}).format(parseFloat(e.amount))))]),t._v(")\n                      ")]):t._e(),t._v(" "),"transfer"===e.type?n("span",[t._v("\n                        ("),n("span",{staticClass:"text-info"},[t._v(t._s(Intl.NumberFormat(t.locale,{style:"currency",currency:e.currency_code}).format(parseFloat(e.amount))))]),t._v(")\n                      ")]):t._e(),t._v(" "),t._m(1,!0)])})),0):t._e(),t._v(" "),t.links.length>0?n("div",{staticClass:"form-text"},[t._m(2)]):t._e()])])]),t._v(" "),n("div",{staticClass:"modal",attrs:{tabindex:"-1",id:"linkModal"}},[n("div",{staticClass:"modal-dialog modal-lg"},[n("div",{staticClass:"modal-content"},[t._m(3),t._v(" "),n("div",{staticClass:"modal-body"},[n("div",{staticClass:"container-fluid"},[t._m(4),t._v(" "),n("div",{staticClass:"row"},[n("div",{staticClass:"col"},[n("form",{on:{submit:function(e){return e.preventDefault(),t.search(e)}}},[n("div",{staticClass:"input-group"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.query,expression:"query"}],staticClass:"form-control",attrs:{autocomplete:"off",maxlength:"255",type:"text",name:"search",id:"query",placeholder:"Search query"},domProps:{value:t.query},on:{input:function(e){e.target.composing||(t.query=e.target.value)}}}),t._v(" "),t._m(5)])])])]),t._v(" "),n("div",{staticClass:"row"},[n("div",{staticClass:"col"},[t.searching?n("span",[n("i",{staticClass:"fas fa-spinner fa-spin"})]):t._e(),t._v(" "),t.searchResults.length>0?n("h4",[t._v("Search results")]):t._e(),t._v(" "),t.searchResults.length>0?n("table",{staticClass:"table table-sm"},[t._m(6),t._v(" "),n("tbody",t._l(t.searchResults,(function(e){return n("tr",[n("td",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.selected,expression:"result.selected"}],staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.selected)?t._i(e.selected,null)>-1:e.selected},on:{change:[function(n){var s=e.selected,i=n.target,a=!!i.checked;if(Array.isArray(s)){var r=t._i(s,null);i.checked?r<0&&t.$set(e,"selected",s.concat([null])):r>-1&&t.$set(e,"selected",s.slice(0,r).concat(s.slice(r+1)))}else t.$set(e,"selected",a)},function(e){return t.selectTransaction(e)}]}})]),t._v(" "),n("td",[n("select",{directives:[{name:"model",rawName:"v-model",value:e.link_type_id,expression:"result.link_type_id"}],staticClass:"form-control",on:{change:[function(n){var s=Array.prototype.filter.call(n.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(e,"link_type_id",n.target.multiple?s:s[0])},function(e){return t.selectLinkType(e)}]}},t._l(t.linkTypes,(function(e){return n("option",{attrs:{label:e.type},domProps:{value:e.id+"-"+e.direction}},[t._v(t._s(e.type)+"\n                        ")])})),0)]),t._v(" "),n("td",[n("a",{attrs:{href:"./transactions/show/"+e.transaction_group_id}},[t._v(t._s(e.description))]),t._v(" "),"withdrawal"===e.type?n("span",[t._v("\n                        ("),n("span",{staticClass:"text-danger"},[t._v(t._s(Intl.NumberFormat(t.locale,{style:"currency",currency:e.currency_code}).format(-1*parseFloat(e.amount))))]),t._v(")\n                      ")]):t._e(),t._v(" "),"deposit"===e.type?n("span",[t._v("\n                        ("),n("span",{staticClass:"text-success"},[t._v(t._s(Intl.NumberFormat(t.locale,{style:"currency",currency:e.currency_code}).format(parseFloat(e.amount))))]),t._v(")\n                      ")]):t._e(),t._v(" "),"transfer"===e.type?n("span",[t._v("\n                        ("),n("span",{staticClass:"text-info"},[t._v(t._s(Intl.NumberFormat(t.locale,{style:"currency",currency:e.currency_code}).format(parseFloat(e.amount))))]),t._v(")\n                      ")]):t._e(),t._v(" "),n("br"),t._v(" "),n("em",[n("a",{attrs:{href:"./accounts/show/"+e.source_id}},[t._v(t._s(e.source_name))]),t._v("\n                        →\n                        "),n("a",{attrs:{href:"./accounts/show/"+e.destination_id}},[t._v(t._s(e.destination_name))])])])])})),0)]):t._e()])])])]),t._v(" "),t._m(7)])])])]):t._e()}),[function(){var t=this.$createElement,e=this._self._c||t;return e("button",{staticClass:"btn btn-default btn-xs",attrs:{"data-toggle":"modal","data-target":"#linkModal"}},[e("i",{staticClass:"fas fa-plus"}),this._v(" Add transaction link")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"btn-group btn-group-xs float-right"},[e("a",{staticClass:"btn btn-xs btn-default",attrs:{tabindex:"-1",href:"#"}},[e("i",{staticClass:"far fa-edit"})]),this._v(" "),e("a",{staticClass:"btn btn-xs btn-danger",attrs:{tabindex:"-1",href:"#"}},[e("i",{staticClass:"far fa-trash-alt"})])])},function(){var t=this.$createElement,e=this._self._c||t;return e("button",{staticClass:"btn btn-default",attrs:{"data-toggle":"modal","data-target":"#linkModal"}},[e("i",{staticClass:"fas fa-plus"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"modal-header"},[e("h5",{staticClass:"modal-title"},[this._v("Transaction thing dialog.")]),this._v(" "),e("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[e("span",{attrs:{"aria-hidden":"true"}},[this._v("×")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"row"},[e("div",{staticClass:"col"},[e("p",[this._v("\n                  Use this form to search for transactions you wish to link to this one. When in doubt, use "),e("code",[this._v("id:*")]),this._v(" where the ID is the number from\n                  the URL.\n                ")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"input-group-append"},[e("button",{staticClass:"btn btn-default",attrs:{type:"submit"}},[e("i",{staticClass:"fas fa-search"}),this._v(" Search")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",{staticStyle:{width:"33%"},attrs:{colspan:"2"}},[this._v("Include?")]),this._v(" "),e("th",[this._v("Transaction")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-dismiss":"modal"}},[this._v("Close")])])}],!1,null,null,null).exports,_t={name:"TransactionAttachments",props:["transaction_journal_id","customFields"],data:function(){return{availableFields:this.customFields}},watch:{customFields:function(t){this.availableFields=t},transaction_journal_id:function(t){if(!this.showField)return console.log("Field is hidden. Emit event!"),void this.$emit("uploaded-attachments",t);0!==t&&this.doUpload()}},computed:{showField:function(){return"attachments"in this.availableFields&&this.availableFields.attachments}},methods:{doUpload:function(){var t=this;for(var e in console.log("Now in doUpload() for "+this.$refs.att.files.length+" files."),this.$refs.att.files)this.$refs.att.files.hasOwnProperty(e)&&/^0$|^[1-9]\d*$/.test(e)&&e<=4294967294&&function(){var n=t.$refs.att.files[e],s=new FileReader,i=t;s.onloadend=function(t){var e=this;if(t.target.readyState===FileReader.DONE){var s={filename:n.name,attachable_type:"TransactionJournal",attachable_id:i.transaction_journal_id};axios.post("./api/v1/attachments",s).then((function(n){var s="./api/v1/attachments/"+n.data.data.id+"/upload";axios.post(s,new Blob([t.target.result])).then((function(t){console.log("Uploaded a file. Emit event!"),i.$emit("uploaded-attachments",e.transaction_journal_id)}))}))}},s.readAsArrayBuffer(n)}();0===this.$refs.att.files.length&&(console.log("No files to upload. Emit event!"),this.$emit("uploaded-attachments",this.transaction_journal_id))}}},vt=Object(r.a)(_t,(function(){var t=this.$createElement,e=this._self._c||t;return this.showField?e("div",{staticClass:"form-group"},[e("div",{staticClass:"text-xs d-none d-lg-block d-xl-block"},[this._v("\n    "+this._s(this.$t("firefly.attachments"))+"\n  ")]),this._v(" "),e("div",{staticClass:"input-group"},[e("input",{ref:"att",staticClass:"form-control",attrs:{type:"file",multiple:"",name:"attachments[]"}})])]):this._e()}),[],!1,null,"4957e769",null).exports,gt=n(428),yt=n(429),bt=n(430),xt=(n(411),n(4)),Ct=n.n(xt);delete Ct.a.Icon.Default.prototype._getIconUrl,Ct.a.Icon.Default.mergeOptions({iconRetinaUrl:n(415),iconUrl:n(231),shadowUrl:n(416)});var Tt={name:"TransactionLocation",props:["index","value","errors","customFields"],components:{LMap:gt.a,LTileLayer:yt.a,LMarker:bt.a},created:function(){var t=this;axios.get("./api/v1/configuration/static/firefly.default_location").then((function(e){t.zoom=parseInt(e.data["firefly.default_location"].zoom_level),t.center=[parseFloat(e.data["firefly.default_location"].latitude),parseFloat(e.data["firefly.default_location"].longitude)]}))},data:function(){return{availableFields:this.customFields,url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",zoom:3,center:[0,0],bounds:null,map:null,hasMarker:!1,marker:[0,0]}},methods:{prepMap:function(){this.map=this.$refs.myMap.mapObject,this.map.on("contextmenu",this.setObjectLocation),this.map.on("zoomend",this.saveZoomLevel)},setObjectLocation:function(t){this.marker=[t.latlng.lat,t.latlng.lng],this.hasMarker=!0,this.emitEvent()},saveZoomLevel:function(){this.emitEvent()},clearLocation:function(){this.hasMarker=!1,this.emitEvent()},emitEvent:function(){this.$emit("set-marker-location",{zoomLevel:this.zoom,lat:this.marker[0],lng:this.marker[1],hasMarker:this.hasMarker})},zoomUpdated:function(t){this.zoom=t},centerUpdated:function(t){this.center=t},boundsUpdated:function(t){this.bounds=t}},computed:{showField:function(){return"location"in this.availableFields&&this.availableFields.location}},watch:{customFields:function(t){this.availableFields=t}}},kt=Object(r.a)(Tt,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.showField?n("div",{staticClass:"form-group"},[n("div",{staticClass:"text-xs d-none d-lg-block d-xl-block"},[t._v("\n    "+t._s(t.$t("firefly.location"))+"\n  ")]),t._v(" "),n("div",{staticStyle:{width:"100%",height:"300px"}},[n("l-map",{ref:"myMap",staticStyle:{width:"100%",height:"300px"},attrs:{zoom:t.zoom,center:t.center},on:{ready:function(e){return t.prepMap()},"update:zoom":t.zoomUpdated,"update:center":t.centerUpdated,"update:bounds":t.boundsUpdated}},[n("l-tile-layer",{attrs:{url:t.url}}),t._v(" "),n("l-marker",{attrs:{"lat-lng":t.marker,visible:t.hasMarker}})],1),t._v(" "),n("span",[n("button",{staticClass:"btn btn-default btn-xs",on:{click:t.clearLocation}},[t._v(t._s(t.$t("firefly.clear_location")))])])],1),t._v(" "),n("p",[t._v(" ")])]):t._e()}),[],!1,null,"6cf6c869",null).exports;function wt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,s)}return n}function $t(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?wt(Object(n),!0).forEach((function(e){Ft(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):wt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Ft(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var At=Object(i.b)("transactions/create"),Ot=(At.mapState,At.mapGetters),jt=(At.mapActions,At.mapMutations,{name:"SplitForm",props:["transaction","split","count","customFields","index","submittedTransaction"],computed:$t($t({},Ot(["transactionType","date","time"])),{},{splitDate:function(){return this.date},splitTime:function(){return this.time},sourceAccount:function(){return{id:this.transaction.source_account_id,name:this.transaction.source_account_name,type:this.transaction.source_account_type}},destinationAccount:function(){return{id:this.transaction.destination_account_id,name:this.transaction.destination_account_name,type:this.transaction.destination_account_type}},hasMetaFields:function(){var t=["internal_reference","notes","attachments","external_uri","location","links"];for(var e in this.customFields)if(this.customFields.hasOwnProperty(e)&&t.includes(e)&&!0===this.customFields[e])return!0;return!1}}),components:{TransactionLocation:kt,SplitPills:l,TransactionAttachments:vt,TransactionNotes:pt,TransactionExternalUrl:ut,TransactionInternalReference:ct,TransactionPiggyBank:rt,TransactionTags:it,TransactionLinks:ht,TransactionBill:Q,TransactionCategory:Z,TransactionCustomDates:J,TransactionForeignCurrency:H,TransactionForeignAmount:G,TransactionAmount:z,SwitchAccount:R,TransactionAccount:D,TransactionBudget:w,TransactionDescription:x,TransactionDate:T}}),St=Object(r.a)(jt,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:"tab-pane"+(0===t.index?" active":""),attrs:{id:"split_"+t.index}},[n("div",{staticClass:"row"},[n("div",{staticClass:"col"},[n("div",{staticClass:"card"},[n("div",{staticClass:"card-header"},[n("h3",{staticClass:"card-title"},[t._v("\n            "+t._s(t.$t("firefly.basic_journal_information"))+"\n            "),t.count>1?n("span",[t._v("("+t._s(t.index+1)+" / "+t._s(t.count)+") ")]):t._e()])]),t._v(" "),n("div",{staticClass:"card-body"},[n("div",{staticClass:"row"},[n("div",{staticClass:"col"},[n("TransactionDescription",t._g({attrs:{index:t.index,errors:t.transaction.errors.description},model:{value:t.transaction.description,callback:function(e){t.$set(t.transaction,"description",e)},expression:"transaction.description"}},t.$listeners))],1)]),t._v(" "),n("div",{staticClass:"row"},[n("div",{staticClass:"col-xl-5 col-lg-5 col-md-10 col-sm-12 col-xs-12"},[n("TransactionAccount",t._g({attrs:{direction:"source",index:t.index,errors:t.transaction.errors.source},model:{value:t.sourceAccount,callback:function(e){t.sourceAccount=e},expression:"sourceAccount"}},t.$listeners))],1),t._v(" "),n("div",{staticClass:"col-xl-2 col-lg-2 col-md-2 col-sm-12 text-center d-none d-sm-block"},[0===t.index?n("SwitchAccount",t._g({attrs:{index:t.index}},t.$listeners)):t._e()],1),t._v(" "),n("div",{staticClass:"col-xl-5 col-lg-5 col-md-12 col-sm-12 col-xs-12"},[n("TransactionAccount",t._g({attrs:{direction:"destination",index:t.index,errors:t.transaction.errors.destination},model:{value:t.destinationAccount,callback:function(e){t.destinationAccount=e},expression:"destinationAccount"}},t.$listeners))],1)]),t._v(" "),n("div",{staticClass:"row"},[n("div",{staticClass:"col-xl-5 col-lg-5 col-md-10 col-sm-12 col-xs-12"},[n("TransactionAmount",t._g({attrs:{index:t.index,errors:t.transaction.errors.amount,amount:t.transaction.amount,"transaction-type":this.transactionType,"source-currency-symbol":this.transaction.source_account_currency_symbol,"destination-currency-symbol":this.transaction.destination_account_currency_symbol}},t.$listeners))],1),t._v(" "),n("div",{staticClass:"col-xl-2 col-lg-2 col-md-2 col-sm-12 text-center d-none d-sm-block"},[n("TransactionForeignCurrency",t._g({attrs:{"transaction-type":this.transactionType,"source-currency-id":this.transaction.source_account_currency_id,"destination-currency-id":this.transaction.destination_account_currency_id,"selected-currency-id":this.transaction.foreign_currency_id,index:t.index}},t.$listeners))],1),t._v(" "),n("div",{staticClass:"col-xl-5 col-lg-5 col-md-12 col-sm-12 col-xs-12"},[n("TransactionForeignAmount",t._g({attrs:{index:t.index,errors:t.transaction.errors.foreign_amount,"transaction-type":this.transactionType,"source-currency-id":this.transaction.source_account_currency_id,"destination-currency-id":this.transaction.destination_account_currency_id,"selected-currency-id":this.transaction.foreign_currency_id}},t.$listeners))],1)]),t._v(" "),n("div",{staticClass:"row"},[n("div",{staticClass:"col-xl-5 col-lg-5 col-md-12 col-sm-12 col-xs-12"},[n("TransactionDate",t._g({attrs:{index:t.index,date:t.splitDate,time:t.splitTime,errors:t.transaction.errors.date}},t.$listeners))],1),t._v(" "),n("div",{staticClass:"col-xl-5 col-lg-5 col-md-12 col-sm-12 col-xs-12 offset-xl-2 offset-lg-2"},[n("TransactionCustomDates",t._g({attrs:{index:t.index,"custom-fields":t.customFields,errors:t.transaction.errors.custom_dates,"interest-date":t.transaction.interest_date,"book-date":t.transaction.book_date,"process-date":t.transaction.process_date,"due-date":t.transaction.due_date,"payment-date":t.transaction.payment_date,"invoice-date":t.transaction.invoice_date},on:{"update:customFields":function(e){t.customFields=e},"update:custom-fields":function(e){t.customFields=e}}},t.$listeners))],1)])])])])]),t._v(" "),n("div",{staticClass:"row"},[n("div",{staticClass:"col"},[n("div",{staticClass:"card"},[n("div",{staticClass:"card-header"},[n("h3",{staticClass:"card-title"},[t._v("\n            "+t._s(t.$t("firefly.transaction_journal_meta"))+"\n            "),t.count>1?n("span",[t._v("("+t._s(t.index+1)+" / "+t._s(t.count)+") ")]):t._e()])]),t._v(" "),n("div",{staticClass:"card-body"},[n("div",{staticClass:"row"},[n("div",{staticClass:"col-xl-6 col-lg-6 col-md-12 col-sm-12 col-xs-12"},["Transfer"!==t.transactionType&&"Deposit"!==t.transactionType?n("TransactionBudget",t._g({attrs:{index:t.index,errors:t.transaction.errors.budget},model:{value:t.transaction.budget_id,callback:function(e){t.$set(t.transaction,"budget_id",e)},expression:"transaction.budget_id"}},t.$listeners)):t._e(),t._v(" "),n("TransactionCategory",t._g({attrs:{index:t.index,errors:t.transaction.errors.category},model:{value:t.transaction.category,callback:function(e){t.$set(t.transaction,"category",e)},expression:"transaction.category"}},t.$listeners))],1),t._v(" "),n("div",{staticClass:"col-xl-6 col-lg-6 col-md-12 col-sm-12 col-xs-12"},["Transfer"!==t.transactionType&&"Deposit"!==t.transactionType?n("TransactionBill",t._g({attrs:{index:t.index,errors:t.transaction.errors.bill},model:{value:t.transaction.bill_id,callback:function(e){t.$set(t.transaction,"bill_id",e)},expression:"transaction.bill_id"}},t.$listeners)):t._e(),t._v(" "),n("TransactionTags",t._g({attrs:{index:t.index,errors:t.transaction.errors.tags},model:{value:t.transaction.tags,callback:function(e){t.$set(t.transaction,"tags",e)},expression:"transaction.tags"}},t.$listeners)),t._v(" "),"Withdrawal"!==t.transactionType&&"Deposit"!==t.transactionType?n("TransactionPiggyBank",t._g({attrs:{index:t.index,errors:t.transaction.errors.piggy_bank},model:{value:t.transaction.piggy_bank_id,callback:function(e){t.$set(t.transaction,"piggy_bank_id",e)},expression:"transaction.piggy_bank_id"}},t.$listeners)):t._e()],1)])])])])]),t._v(" "),t.hasMetaFields?n("div",{staticClass:"row"},[n("div",{staticClass:"col"},[n("div",{staticClass:"card"},[n("div",{staticClass:"card-header"},[n("h3",{staticClass:"card-title"},[t._v("\n            "+t._s(t.$t("firefly.transaction_journal_extra"))+"\n            "),t.count>1?n("span",[t._v("("+t._s(t.index+1)+" / "+t._s(t.count)+") ")]):t._e()])]),t._v(" "),n("div",{staticClass:"card-body"},[n("div",{staticClass:"row"},[n("div",{staticClass:"col-xl-6 col-lg-6 col-md-12 col-sm-12 col-xs-12"},[n("TransactionInternalReference",t._g({attrs:{index:t.index,errors:t.transaction.errors.internal_reference,"custom-fields":t.customFields},on:{"update:customFields":function(e){t.customFields=e},"update:custom-fields":function(e){t.customFields=e}},model:{value:t.transaction.internal_reference,callback:function(e){t.$set(t.transaction,"internal_reference",e)},expression:"transaction.internal_reference"}},t.$listeners)),t._v(" "),n("TransactionExternalUrl",t._g({attrs:{index:t.index,errors:t.transaction.errors.external_url,"custom-fields":t.customFields},on:{"update:customFields":function(e){t.customFields=e},"update:custom-fields":function(e){t.customFields=e}},model:{value:t.transaction.external_url,callback:function(e){t.$set(t.transaction,"external_url",e)},expression:"transaction.external_url"}},t.$listeners)),t._v(" "),n("TransactionNotes",t._g({attrs:{index:t.index,errors:t.transaction.errors.notes,"custom-fields":t.customFields},on:{"update:customFields":function(e){t.customFields=e},"update:custom-fields":function(e){t.customFields=e}},model:{value:t.transaction.notes,callback:function(e){t.$set(t.transaction,"notes",e)},expression:"transaction.notes"}},t.$listeners))],1),t._v(" "),n("div",{staticClass:"col-xl-6 col-lg-6 col-md-12 col-sm-12 col-xs-12"},[n("TransactionAttachments",t._g({ref:"attachments",attrs:{index:t.index,transaction_journal_id:t.transaction.transaction_journal_id,submitted_transaction:t.submittedTransaction,"custom-fields":t.customFields},on:{"update:customFields":function(e){t.customFields=e},"update:custom-fields":function(e){t.customFields=e}},model:{value:t.transaction.attachments,callback:function(e){t.$set(t.transaction,"attachments",e)},expression:"transaction.attachments"}},t.$listeners)),t._v(" "),n("TransactionLocation",t._g({attrs:{index:t.index,errors:t.transaction.errors.location,"custom-fields":t.customFields},on:{"update:customFields":function(e){t.customFields=e},"update:custom-fields":function(e){t.customFields=e}},model:{value:t.transaction.notes,callback:function(e){t.$set(t.transaction,"notes",e)},expression:"transaction.notes"}},t.$listeners)),t._v(" "),n("TransactionLinks",t._g({attrs:{index:t.index,"custom-fields":t.customFields},on:{"update:customFields":function(e){t.customFields=e},"update:custom-fields":function(e){t.customFields=e}},model:{value:t.transaction.links,callback:function(e){t.$set(t.transaction,"links",e)},expression:"transaction.links"}},t.$listeners))],1)])])])])]):t._e()])}),[],!1,null,null,null).exports;function Pt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,s)}return n}function Dt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Pt(Object(n),!0).forEach((function(e){Et(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Pt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Et(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Lt=Object(i.b)("transactions/create"),It=(Lt.mapState,Lt.mapGetters),Nt=(Lt.mapActions,Lt.mapMutations),Mt={name:"Create",components:{SplitForm:St,Alert:o,SplitPills:l,TransactionGroupTitle:y},created:function(){this.storeAllowedOpposingTypes(),this.storeAccountToTransaction(),this.storeCustomFields(),this.addTransaction()},data:function(){return{errorMessage:"",successMessage:"",customFields:[],enableSubmit:!0,createAnother:!1,resetFormAfter:!1,submittedTransaction:!1,submittedLinks:!1,submittedAttachments:!1,inError:!1,submittedAttCount:{},groupTitleErrors:[],returnedGroupId:0,returnedGroupTitle:"",accountToTransaction:{}}},computed:Dt({},It(["transactionType","transactions","date","time","groupTitle"])),watch:{submittedTransaction:function(){this.finalizeSubmit()},submittedLinks:function(){this.finalizeSubmit()},submittedAttachments:function(){this.finalizeSubmit()}},methods:Dt(Dt({},Nt(["addTransaction","deleteTransaction","setAllowedOpposingTypes","setTransactionError","setTransactionType","resetErrors","updateField","resetTransactions","setDate","setTime"])),{},{removeTransaction:function(t){this.$store.commit("transactions/create/deleteTransaction",{index:t})},storeCustomFields:function(){var t=this;axios.get("./api/v1/preferences/transaction_journal_optional_fields").then((function(e){t.customFields=e.data.data.attributes.data}))},finalizeSubmit:function(){var t=this;if(console.log("finalizeSubmit ("+this.submittedTransaction+", "+this.submittedAttachments+", "+this.submittedLinks+")"),this.submittedTransaction&&this.submittedAttachments&&this.submittedLinks){var e;if(console.log("all true"),console.log("createAnother = "+this.createAnother),console.log("inError = "+this.inError),!1===this.createAnother&&!1===this.inError)return console.log("redirect"),void(window.location.href=(null!==(e=window.previousURL)&&void 0!==e?e:"/")+"?transaction_group_id="+this.returnedGroupId+"&message=created");for(var n in!1===this.inError&&(this.errorMessage="",this.successMessage=this.$t("firefly.transaction_stored_link",{ID:this.returnedGroupId,title:this.returnedGroupTitle})),this.enableSubmit=!0,this.submittedTransaction=!1,this.submittedLinks=!1,this.submittedAttachments=!1,this.inError=!1,this.transactions)this.transactions.hasOwnProperty(n)&&/^0$|^[1-9]\d*$/.test(n)&&n<=4294967294&&this.transactions.hasOwnProperty(n)&&this.updateField({index:n,field:"transaction_journal_id",value:0});this.submittedAttCount=[],this.resetFormAfter&&(this.resetTransactions(),setTimeout((function(){return t.addTransaction()}),50))}},submitTransaction:function(){var t=this;console.log("submitTransaction()"),this.enableSubmit=!1;var e=this.convertData();console.log("Will submit:"),console.log(e),axios.post("./api/v1/transactions",e).then((function(n){console.log("Response is OK!"),t.submittedTransaction=!0,t.submitTransactionLinks(e,n),t.submitAttachments(e,n),t.returnedGroupId=parseInt(n.data.data.id),t.returnedGroupTitle=null===n.data.data.attributes.group_title?n.data.data.attributes.transactions[0].description:n.data.data.attributes.group_title})).catch((function(e){t.enableSubmit=!0,t.submittedTransaction=!0,t.submittedAttachments=!0,t.submittedLinks=!0,t.inError=!0,t.parseErrors(e.response.data)}))},submitAttachments:function(t,e){console.log("submitAttachments()");var n=e.data.data.attributes.transactions;for(var s in t.transactions)t.transactions.hasOwnProperty(s)&&/^0$|^[1-9]\d*$/.test(s)&&s<=4294967294&&n.hasOwnProperty(s)&&this.updateField({index:s,field:"transaction_journal_id",value:n[0].transaction_journal_id})},uploadedAttachment:function(t){console.log("Triggered uploadedAttachment("+t+")");var e="str"+t;this.submittedAttCount[e]=1,Object.keys(this.submittedAttCount).length===this.transactions.length&&(this.submittedAttachments=!0)},storeLocation:function(t,e){var n=e.hasMarker?e.zoomLevel:null,s=e.hasMarker?e.lat:null,i=e.hasMarker?e.lng:null;this.updateField({index:t,field:"zoom_level",value:n}),this.updateField({index:t,field:"latitude",value:s}),this.updateField({index:t,field:"longitude",value:i})},storeAccountValue:function(t,e,n,s){var i=e+"_account_"+n;this.updateField({index:t,field:i,value:s}),"type"===n&&this.calculateTransactionType(t)},storeDescription:function(t,e){this.updateField({field:"description",index:t,value:e})},storeForeignCurrencyId:function(t,e){console.log("storeForeignCurrencyId("+t+","+e+")"),this.updateField({field:"foreign_currency_id",index:t,value:e})},storeAmount:function(t,e){this.updateField({field:"amount",index:t,value:e})},storeForeignAmount:function(t,e){this.updateField({field:"foreign_amount",index:t,value:e})},storeDate:function(t){this.setDate(t.date)},storeTime:function(t){this.setTime(t.time)},storeCustomDate:function(t,e){this.updateField({field:e.field,index:t,value:e.date})},storeBudget:function(t,e){this.updateField({field:"budget_id",index:t,value:e})},storeCategory:function(t,e){this.updateField({field:"category",index:t,value:e})},storeBill:function(t,e){this.updateField({field:"bill_id",index:t,value:e})},storeTags:function(t,e){this.updateField({field:"tags",index:t,value:e})},storePiggyBank:function(t,e){this.updateField({field:"piggy_bank_id",index:t,value:e})},storeInternalReference:function(t,e){this.updateField({field:"internal_reference",index:t,value:e})},storeExternalUrl:function(t,e){this.updateField({field:"external_url",index:t,value:e})},storeNotes:function(t,e){this.updateField({field:"notes",index:t,value:e})},storeLinks:function(t,e){this.updateField({field:"links",index:t,value:e})},calculateTransactionType:function(t){if(0===t){var e=this.transactions[0].source_account_type,n=this.transactions[0].destination_account_type;if(null===e||null===n)return void this.setTransactionType("any");if(""===e||""===n)return void this.setTransactionType("any");var s=this.accountToTransaction[e];if(void 0!==s){var i=s[n];if(void 0!==s[n])return void this.setTransactionType(i)}"Asset account"!==e&&this.updateField({index:0,field:"destination_account_id",value:null}),"Asset account"!==n&&this.updateField({index:0,field:"source_account_id",value:null}),this.setTransactionType("any")}},submitTransactionLinks:function(t,e){var n=[],s=e.data.data.attributes.transactions,i=0;for(var a in t.transactions)if(t.transactions.hasOwnProperty(a)&&/^0$|^[1-9]\d*$/.test(a)&&a<=4294967294){var r=t.transactions[a];if(s.hasOwnProperty(a)){var o=s[a];for(var c in r.links)if(r.links.hasOwnProperty(c)&&/^0$|^[1-9]\d*$/.test(c)&&c<=4294967294){var l=r.links[c];i++,0===l.outward_id&&(l.outward_id=o.transaction_journal_id),0===l.inward_id&&(l.inward_id=o.transaction_journal_id),n.push(axios.post("./api/v1/transaction_links",l).then((function(t){})))}}}0!==i?Promise.all(n).then((function(){this.submittedLinks=!0})):this.submittedLinks=!0},parseErrors:function(t){for(var e in this.transactions)this.resetErrors({index:e});var n,s,i;for(var a in this.successMessage="",this.errorMessage=this.$t("firefly.errors_submission"),void 0===t.errors&&(this.successMessage="",this.errorMessage=t.message),t.errors)if(t.errors.hasOwnProperty(a)){if("group_title"===a){this.groupTitleErrors=t.errors[a];continue}if("group_title"!==a)switch(s=parseInt(a.split(".")[1]),i=a.split(".")[2]){case"amount":case"description":case"date":case"tags":n={index:s,field:i,errors:t.errors[a]},this.setTransactionError(n);break;case"budget_id":n={index:s,field:"budget",errors:t.errors[a]},this.setTransactionError(n);break;case"bill_id":n={index:s,field:"bill",errors:t.errors[a]},this.setTransactionError(n);break;case"piggy_bank_id":n={index:s,field:"piggy_bank",errors:t.errors[a]},this.setTransactionError(n);break;case"category_name":n={index:s,field:"category",errors:t.errors[a]},this.setTransactionError(n);break;case"source_name":case"source_id":n={index:s,field:"source",errors:t.errors[a]},this.setTransactionError(n);break;case"destination_name":case"destination_id":n={index:s,field:"destination",errors:t.errors[a]},this.setTransactionError(n);break;case"foreign_amount":case"foreign_currency":n={index:s,field:"foreign_amount",errors:t.errors[a]},this.setTransactionError(n)}this.transactions[s]}},convertData:function(){var t={transactions:[]};for(var e in this.groupTitle.length>0&&(t.group_title=this.groupTitle),this.transactions)this.transactions.hasOwnProperty(e)&&/^0$|^[1-9]\d*$/.test(e)&&e<=4294967294&&t.transactions.push(this.convertSplit(e,this.transactions[e]));return t.transactions.length>1&&(t.group_title=t.transactions[0].description),t.transactions.length>1&&(t=this.synchronizeAccounts(t)),t},synchronizeAccounts:function(t){for(var e in t.transactions)t.transactions.hasOwnProperty(e)&&/^0$|^[1-9]\d*$/.test(e)&&e<=4294967294&&("Transfer"===this.transactionType&&(t.transactions[e].source_name=null,t.transactions[e].destination_name=null,e>0&&(t.transactions[e].source_id=t.transactions[0].source_id,t.transactions[e].destination_id=t.transactions[0].destination_id)),"Deposit"===this.transactionType&&(t.transactions[e].destination_name=null,e>0&&(t.transactions[e].destination_id=t.transactions[0].destination_id)),"Withdrawal"===this.transactionType&&(t.transactions[e].source_name=null,e>0&&(t.transactions[e].source_id=t.transactions[0].source_id)));return t},switchAccounts:function(t){console.log("user wants to switch Accounts");var e=this.transactions[t].source_account_id,n=this.transactions[t].source_account_name,s=this.transactions[t].source_account_type,i=this.transactions[t].destination_account_id,a=this.transactions[t].destination_account_name,r=this.transactions[t].destination_account_type;this.updateField({index:0,field:"source_account_id",value:i}),this.updateField({index:0,field:"source_account_name",value:a}),this.updateField({index:0,field:"source_account_type",value:r}),this.updateField({index:0,field:"destination_account_id",value:e}),this.updateField({index:0,field:"destination_account_name",value:n}),this.updateField({index:0,field:"destination_account_type",value:s}),this.calculateTransactionType(0)},convertSplit:function(t,e){var n,s,i,a,r="invalid";if(this.time instanceof Date&&!isNaN(this.time)&&this.date instanceof Date&&!isNaN(this.date)){var o=new Date(this.date);o.setHours(this.time.getHours()),o.setMinutes(this.time.getMinutes()),o.setSeconds(this.time.getSeconds()),r=this.toW3CString(this.date)}var c,l,u,d={description:e.description,date:r,type:this.transactionType,source_id:null!==(n=e.source_account_id)&&void 0!==n?n:null,source_name:null!==(s=e.source_account_name)&&void 0!==s?s:null,destination_id:null!==(i=e.destination_account_id)&&void 0!==i?i:null,destination_name:null!==(a=e.destination_account_name)&&void 0!==a?a:null,currency_id:e.currency_id,amount:e.amount,budget_id:e.budget_id,category_name:e.category,tags:e.tags,interest_date:e.interest_date,book_date:e.book_date,process_date:e.process_date,due_date:e.due_date,payment_date:e.payment_date,invoice_date:e.invoice_date,internal_reference:e.internal_reference,external_url:e.external_url,notes:e.notes,external_id:e.external_id,zoom_level:e.zoom_level,longitude:e.longitude,latitude:e.latitude,order:0,reconciled:!1};0!==e.piggy_bank_id&&(d.piggy_bank_id=e.piggy_bank_id),0!==e.bill_id&&(d.bill_id=e.bill_id),0!==e.foreign_currency_id&&""!==e.foreign_amount&&(d.foreign_currency_id=e.foreign_currency_id),""!==e.foreign_amount&&(d.foreign_amount=e.foreign_amount),c=this.transactionType?this.transactionType.toLowerCase():"any",l=this.transactions[0].source_account_type,u=this.transactions[0].destination_account_type,d.currency_id=e.source_account_currency_id,"any"===c&&["asset","Asset account","Loan","Debt","Mortgage"].includes(l)&&(c="withdrawal"),"any"===c&&["asset","Asset account","Loan","Debt","Mortgage"].includes(u)&&(c="deposit",d.currency_id=e.destination_account_currency_id),d.type=c;var p=[];for(var f in e.links)if(e.links.hasOwnProperty(f)&&/^0$|^[1-9]\d*$/.test(f)&&f<=4294967294){var m=e.links[f],h=m.link_type_id.split("-"),_="outward"===h[1]?0:parseInt(m.transaction_journal_id),v="inward"===h[1]?0:parseInt(m.transaction_journal_id),g={link_type_id:parseInt(h[0]),inward_id:_,outward_id:v};p.push(g)}return d.links=p,d},toW3CString:function(t){var e=t.getFullYear(),n=t.getMonth();++n<10&&(n="0"+n);var s=t.getDate();s<10&&(s="0"+s);var i=t.getHours();i<10&&(i="0"+i);var a=t.getMinutes();a<10&&(a="0"+a);var r=t.getSeconds();r<10&&(r="0"+r);var o=-t.getTimezoneOffset(),c=Math.abs(Math.floor(o/60)),l=Math.abs(o)-60*c;c<10&&(c="0"+c),l<10&&(l="0"+l);var u="+";return o<0&&(u="-"),e+"-"+n+"-"+s+"T"+i+":"+a+":"+r+u+c+":"+l},storeAllowedOpposingTypes:function(){this.setAllowedOpposingTypes(window.allowedOpposingTypes)},storeAccountToTransaction:function(){var t=this;axios.get("./api/v1/configuration/static/firefly.account_to_transaction").then((function(e){t.accountToTransaction=e.data["firefly.account_to_transaction"]}))}})},Ut=Object(r.a)(Mt,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("alert",{attrs:{message:t.errorMessage,type:"danger"}}),t._v(" "),n("alert",{attrs:{message:t.successMessage,type:"success"}}),t._v(" "),n("SplitPills",{attrs:{transactions:t.transactions}}),t._v(" "),n("div",{staticClass:"tab-content"},t._l(this.transactions,(function(e,s){return n("SplitForm",{key:s,attrs:{transaction:e,index:s,count:t.transactions.length,"custom-fields":t.customFields,"submitted-transaction":t.submittedTransaction},on:{"uploaded-attachments":function(e){return t.uploadedAttachment(e)},"set-description":function(e){return t.storeDescription(s,e)},"set-marker-location":function(e){return t.storeLocation(s,e)},"set-source-account-id":function(e){return t.storeAccountValue(s,"source","id",e)},"set-source-account-name":function(e){return t.storeAccountValue(s,"source","name",e)},"set-source-account-type":function(e){return t.storeAccountValue(s,"source","type",e)},"set-source-account-currency-id":function(e){return t.storeAccountValue(s,"source","currency_id",e)},"set-source-account-currency-code":function(e){return t.storeAccountValue(s,"source","currency_code",e)},"set-source-account-currency-symbol":function(e){return t.storeAccountValue(s,"source","currency_symbol",e)},"set-destination-account-id":function(e){return t.storeAccountValue(s,"destination","id",e)},"set-destination-account-name":function(e){return t.storeAccountValue(s,"destination","name",e)},"set-destination-account-type":function(e){return t.storeAccountValue(s,"destination","type",e)},"set-destination-account-currency-id":function(e){return t.storeAccountValue(s,"destination","currency_id",e)},"set-destination-account-currency-code":function(e){return t.storeAccountValue(s,"destination","currency_code",e)},"set-destination-account-currency-symbol":function(e){return t.storeAccountValue(s,"destination","currency_symbol",e)},"switch-accounts":function(e){return t.switchAccounts(e)},"set-amount":function(e){return t.storeAmount(s,e)},"set-foreign-currency-id":function(e){return t.storeForeignCurrencyId(s,e)},"set-foreign-amount":function(e){return t.storeForeignAmount(s,e)},"set-date":function(e){return t.storeDate(e)},"set-time":function(e){return t.storeTime(e)},"set-custom-date":function(e){return t.storeCustomDate(s,e)},"set-budget":function(e){return t.storeBudget(s,e)},"set-category":function(e){return t.storeCategory(s,e)},"set-bill":function(e){return t.storeBill(s,e)},"set-tags":function(e){return t.storeTags(s,e)},"set-piggy-bank":function(e){return t.storePiggyBank(s,e)},"set-internal-reference":function(e){return t.storeInternalReference(s,e)},"set-external-url":function(e){return t.storeExternalUrl(s,e)},"set-notes":function(e){return t.storeNotes(s,e)},"set-links":function(e){return t.storeLinks(s,e)}}})})),1),t._v(" "),n("div",{staticClass:"row"},[n("div",{staticClass:"col-xl-6 col-lg-6 col-md-12 col-sm-12 col-xs-12"},[t.transactions.length>1?n("div",{staticClass:"card"},[n("div",{staticClass:"card-body"},[n("div",{staticClass:"row"},[n("div",{staticClass:"col"},[n("TransactionGroupTitle",{attrs:{errors:this.groupTitleErrors},model:{value:this.groupTitle,callback:function(e){t.$set(this,"groupTitle",e)},expression:"this.groupTitle"}})],1)])])]):t._e()]),t._v(" "),n("div",{staticClass:"col-xl-6 col-lg-6 col-md-12 col-sm-12 col-xs-12"},[n("div",{staticClass:"card"},[n("div",{staticClass:"card-body"},[n("div",{staticClass:"row"},[n("div",{staticClass:"col"},[n("div",{staticClass:"text-xs d-none d-lg-block d-xl-block"},[t._v("\n                 \n              ")]),t._v(" "),n("button",{staticClass:"btn btn-outline-primary btn-block",on:{click:t.addTransaction}},[n("i",{staticClass:"far fa-clone"}),t._v(" "+t._s(t.$t("firefly.add_another_split"))+"\n              ")])]),t._v(" "),n("div",{staticClass:"col"},[n("div",{staticClass:"text-xs d-none d-lg-block d-xl-block"},[t._v("\n                 \n              ")]),t._v(" "),n("button",{staticClass:"btn btn-success btn-block",attrs:{disabled:!t.enableSubmit},on:{click:t.submitTransaction}},[t.enableSubmit?n("span",[n("i",{staticClass:"far fa-save"}),t._v(" "+t._s(t.$t("firefly.store_transaction")))]):t._e(),t._v(" "),t.enableSubmit?t._e():n("span",[n("i",{staticClass:"fas fa-spinner fa-spin"})])])])]),t._v(" "),n("div",{staticClass:"row"},[n("div",{staticClass:"col"},[t._v("\n               \n            ")]),t._v(" "),n("div",{staticClass:"col"},[n("div",{staticClass:"form-check"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.createAnother,expression:"createAnother"}],staticClass:"form-check-input",attrs:{type:"checkbox",id:"createAnother"},domProps:{checked:Array.isArray(t.createAnother)?t._i(t.createAnother,null)>-1:t.createAnother},on:{change:function(e){var n=t.createAnother,s=e.target,i=!!s.checked;if(Array.isArray(n)){var a=t._i(n,null);s.checked?a<0&&(t.createAnother=n.concat([null])):a>-1&&(t.createAnother=n.slice(0,a).concat(n.slice(a+1)))}else t.createAnother=i}}}),t._v(" "),n("label",{staticClass:"form-check-label",attrs:{for:"createAnother"}},[n("span",{staticClass:"small"},[t._v(t._s(t.$t("firefly.create_another")))])])]),t._v(" "),n("div",{staticClass:"form-check"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.resetFormAfter,expression:"resetFormAfter"}],staticClass:"form-check-input",attrs:{type:"checkbox",id:"resetFormAfter",disabled:!t.createAnother},domProps:{checked:Array.isArray(t.resetFormAfter)?t._i(t.resetFormAfter,null)>-1:t.resetFormAfter},on:{change:function(e){var n=t.resetFormAfter,s=e.target,i=!!s.checked;if(Array.isArray(n)){var a=t._i(n,null);s.checked?a<0&&(t.resetFormAfter=n.concat([null])):a>-1&&(t.resetFormAfter=n.slice(0,a).concat(n.slice(a+1)))}else t.resetFormAfter=i}}}),t._v(" "),n("label",{staticClass:"form-check-label",attrs:{for:"resetFormAfter"}},[n("span",{staticClass:"small"},[t._v(t._s(t.$t("firefly.reset_after")))])])])])])])])])])],1)}),[],!1,null,"190d9ddc",null).exports,Rt=n(3),Bt=n.n(Rt);n(15),Bt.a.config.productionTip=!1;var zt=n(18),Vt={};new Bt.a({i18n:zt,store:s.a,render:function(t){return t(Ut,{props:Vt})},beforeCreate:function(){this.$store.commit("initialiseStore"),this.$store.dispatch("updateCurrencyPreference")}}).$mount("#transactions_create")}},[[299,0,1]]]);
//# sourceMappingURL=create.js.map