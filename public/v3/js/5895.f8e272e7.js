"use strict";(self["webpackChunkfirefly_iii"]=self["webpackChunkfirefly_iii"]||[]).push([[5895],{5895:(e,t,a)=>{a.r(t),a.d(t,{default:()=>U});var i=a(3673),s=a(2323);const n=(0,i.Uk)("Edit"),r=(0,i.Uk)("Delete");function o(e,t,a,o,l,p){const u=(0,i.up)("q-th"),d=(0,i.up)("q-tr"),g=(0,i.up)("router-link"),h=(0,i.up)("q-td"),c=(0,i.up)("q-item-label"),m=(0,i.up)("q-item-section"),w=(0,i.up)("q-item"),f=(0,i.up)("q-list"),y=(0,i.up)("q-btn-dropdown"),b=(0,i.up)("q-table"),_=(0,i.up)("q-page"),k=(0,i.Q2)("close-popup");return(0,i.wg)(),(0,i.j4)(_,null,{default:(0,i.w5)((()=>[(0,i.Wm)(b,{title:e.$t("firefly.object_groups"),rows:l.rows,columns:l.columns,"row-key":"id",onRequest:p.onRequest,pagination:l.pagination,"onUpdate:pagination":t[0]||(t[0]=e=>l.pagination=e),loading:l.loading,class:"q-ma-md"},{header:(0,i.w5)((e=>[(0,i.Wm)(d,{props:e},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.cols,(t=>((0,i.wg)(),(0,i.j4)(u,{key:t.name,props:e},{default:(0,i.w5)((()=>[(0,i.Uk)((0,s.zw)(t.label),1)])),_:2},1032,["props"])))),128))])),_:2},1032,["props"])])),body:(0,i.w5)((e=>[(0,i.Wm)(d,{props:e},{default:(0,i.w5)((()=>[(0,i.Wm)(h,{key:"title",props:e},{default:(0,i.w5)((()=>[(0,i.Wm)(g,{to:{name:"groups.show",params:{id:e.row.id}},class:"text-primary"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,s.zw)(e.row.title),1)])),_:2},1032,["to"])])),_:2},1032,["props"]),(0,i.Wm)(h,{key:"menu",props:e},{default:(0,i.w5)((()=>[(0,i.Wm)(y,{color:"primary",label:"Actions",size:"sm"},{default:(0,i.w5)((()=>[(0,i.Wm)(f,null,{default:(0,i.w5)((()=>[(0,i.wy)(((0,i.wg)(),(0,i.j4)(w,{clickable:"",to:{name:"groups.edit",params:{id:e.row.id}}},{default:(0,i.w5)((()=>[(0,i.Wm)(m,null,{default:(0,i.w5)((()=>[(0,i.Wm)(c,null,{default:(0,i.w5)((()=>[n])),_:1})])),_:1})])),_:2},1032,["to"])),[[k]]),(0,i.wy)(((0,i.wg)(),(0,i.j4)(w,{clickable:"",onClick:t=>p.deleteGroup(e.row.id,e.row.title)},{default:(0,i.w5)((()=>[(0,i.Wm)(m,null,{default:(0,i.w5)((()=>[(0,i.Wm)(c,null,{default:(0,i.w5)((()=>[r])),_:1})])),_:1})])),_:2},1032,["onClick"])),[[k]])])),_:2},1024)])),_:2},1024)])),_:2},1032,["props"])])),_:2},1032,["props"])])),_:1},8,["title","rows","columns","onRequest","pagination","loading"])])),_:1})}var l=a(3617),p=a(5474);class u{destroy(e){let t="/api/v1/object_groups/"+e;return p.api["delete"](t)}}class d{list(e,t,a){let i="/api/v1/object_groups";return p.api.get(i,{params:{page:t,cache:a,type:e}})}}const g={name:"Index",watch:{$route(e){"groups.index"===e.name&&(this.page=1,this.updateBreadcrumbs(),this.triggerUpdate())}},data(){return{rows:[],pagination:{sortBy:"desc",descending:!1,page:1,rowsPerPage:5,rowsNumber:100},loading:!1,columns:[{name:"title",label:"Title",field:"title",align:"left"},{name:"menu",label:" ",field:"menu",align:"right"}]}},computed:{...(0,l.Se)("fireflyiii",["getRange","getCacheKey","getListPageSize"])},created(){this.pagination.rowsPerPage=this.getListPageSize},mounted(){if(this.type=this.$route.params.type,null===this.getRange.start||null===this.getRange.end){const e=(0,l.oR)();e.subscribe(((e,t)=>{"fireflyiii/setRange"===e.type&&(this.range={start:e.payload.start,end:e.payload.end},this.triggerUpdate())}))}null!==this.getRange.start&&null!==this.getRange.end&&(this.range={start:this.getRange.start,end:this.getRange.end},this.triggerUpdate())},methods:{deleteGroup:function(e,t){this.$q.dialog({title:"Confirm",message:'Do you want to delete group "'+t+'"? Any resources in this group will be saved.',cancel:!0,persistent:!0}).onOk((()=>{this.destroyGroup(e)}))},destroyGroup:function(e){let t=new u;t.destroy(e).then((()=>{this.$store.dispatch("fireflyiii/refreshCacheKey"),this.triggerUpdate()}))},updateBreadcrumbs:function(){this.$route.meta.pageTitle="firefly.groups",this.$route.meta.breadcrumbs=[{title:"groups"}]},onRequest:function(e){this.page=e.pagination.page,this.triggerUpdate()},triggerUpdate:function(){if(this.loading)return;if(null===this.range.start||null===this.range.end)return;this.loading=!0;const e=new d;this.rows=[],e.list(this.page,this.getCacheKey).then((e=>{this.pagination.rowsPerPage=e.data.meta.pagination.per_page,this.pagination.rowsNumber=e.data.meta.pagination.total,this.pagination.page=this.page;for(let t in e.data.data)if(e.data.data.hasOwnProperty(t)){let a=e.data.data[t],i={id:a.id,title:a.attributes.title};this.rows.push(i)}this.loading=!1}))}}};var h=a(4260),c=a(4379),m=a(4993),w=a(8186),f=a(2414),y=a(3884),b=a(2226),_=a(7011),k=a(3414),q=a(2035),R=a(2350),W=a(677),Z=a(7518),P=a.n(Z);const Q=(0,h.Z)(g,[["render",o]]),U=Q;P()(g,"components",{QPage:c.Z,QTable:m.Z,QTr:w.Z,QTh:f.Z,QTd:y.Z,QBtnDropdown:b.Z,QList:_.Z,QItem:k.Z,QItemSection:q.Z,QItemLabel:R.Z}),P()(g,"directives",{ClosePopup:W.Z})}}]);